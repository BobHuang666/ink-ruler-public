import{d as me,l as Ce,k as i,I as te,R as we,a8 as Se,c as n,a as s,a2 as g,F as d,x as f,f as k,e as u,w as h,r as F,T as R,b as p,t as o,S as W,q as X,v as H,N as $e,g as O,a9 as xe,o as a,X as Oe,aa as Te,_ as Le}from"./index-Bn_Xs3lU.js";import{b as Me}from"./classic-CnXJWy7s.js";const Be={class:"classic-browse-page"},Ge={class:"browse-inner"},Ae={class:"sidebar"},De={class:"filter-section-wrap"},Ne={class:"filter-block"},Ve={class:"filter-controls"},je={class:"filter-controls-actions"},ze={class:"tags-grid-2"},Fe=["disabled","onClick"],Pe={class:"tag-btn-count"},Ie={class:"collapsible border-t pt-4 mt-4"},Ue={class:"collapsible-body"},qe={class:"genre-space"},Ee=["disabled","onClick"],Ke={class:"tag-btn-count"},Re={class:"genre-sub-grid"},We=["disabled","onClick"],Xe={class:"tag-btn-count"},He={class:"collapsible border-t pt-4 mt-4"},Je={class:"collapsible-body"},Qe={class:"filter-grid-3"},Ye=["disabled","onClick"],Ze={class:"tag-btn-count"},et={class:"collapsible border-t pt-4 mt-4"},tt={class:"collapsible-body"},st={class:"filter-grid-3"},lt=["disabled","onClick"],at={class:"tag-btn-count"},nt={class:"display-settings-wrap"},ot={class:"display-settings-grid"},ct=["onClick"],it={class:"display-toggle-label"},rt={class:"main-content"},ut={key:0,class:"pagination-wrap pagination-top"},dt={key:1,class:"grid-wrap"},vt={class:"card-inner"},gt={key:0,class:"card-original"},pt={key:1,class:"card-trans-wrap"},yt={class:"card-trans"},_t={class:"card-footer"},bt={class:"card-meta"},ft={key:4,class:"card-genre"},kt={class:"card-right"},ht={class:"card-likes"},mt={key:2,class:"loading-wrap"},Ct={key:3,class:"empty-placeholder"},wt={key:4,class:"pagination-wrap"},L=15,St=me({name:"ClassicBrowse",__name:"Browse",setup($t){const J={格物修身:270,成长成才:185,道德情操:339,哲理思辨:593,济世情怀:67,理想信念:778,文化传承:118,人与自然:313,家国情怀:126},P=Object.keys(J),Q={三国:63,先秦:100,南北朝:36,唐:757,宋:593,明:504,晋:77,汉:26},M=["先秦","汉","三国","晋","南北朝","隋","唐","五代","宋","辽","金","元","明","清","近现代"],se=[...Object.keys(Q)].sort((l,e)=>(M.indexOf(l)>=0?M.indexOf(l):999)-(M.indexOf(e)>=0?M.indexOf(e):999)),B={刘知几:4,卢照邻:16,周敦颐:11,孔子:100,孟浩然:34,崔颢:11,嵇康:1,左思:15,张旭:3,张载:32,文天祥:22,曹丕:21,曹操:26,曹植:25,曾巩:18,朱熹:26,李清照:13,李白:134,李邕:1,杜甫:353,杨炯:15,梅尧臣:4,欧阳修:13,王之涣:2,王安石:27,王昌龄:48,王绩:67,程颐:14,程颢:11,苏洵:18,苏轼:59,苏辙:26,谢朓:8,谢灵运:11,辛弃疾:276,阮籍:18,陆绍珩:504,陶渊明:60,骆宾王:24,高适:45,鲍照:17,黄庭坚:23},le=[...Object.keys(B)].sort((l,e)=>(B[e]??0)-(B[l]??0)),G={诗:["七言律诗","七言排律","七言歌行","七言绝句","乐府诗","五言律诗","五言排律","五言绝句","古体诗"],词:["词"],曲:["曲"],赋:["赋"],文:["书","书启","对策","序","文","碑文","表奏","记","论","语录"]},I={语录:604,五言律诗:255,七言律诗:87,五言绝句:35,七言绝句:100,古体诗:457,词:227,论:35,文:166,五言排律:109,七言排律:2,乐府诗:9,记:28,书:12,序:9,七言歌行:2,书启:8,赋:1,表奏:3,对策:1,碑文:6},ae={文:872,诗:1056,词:227,赋:1},ne=Object.keys(G).filter(l=>(G[l]??[]).some(e=>(I[e]??0)>0)),Y=Ce([{key:"original",label:"原文",value:!0},{key:"translation",label:"译文",value:!0},{key:"author",label:"作者",value:!0},{key:"dynasty",label:"朝代",value:!0},{key:"style",label:"体裁",value:!1},{key:"example",label:"范文",value:!1}]),_=i(P.length>0?[P[0]]:[]),A=i([]),D=i([]),b=i([]),N=i(!1),U=i(!1),S=i(!1),q=i(!1),E=i(!1),V=i(!1),j=i(!1),z=i(!1),y=i([]),$=i(!1),m=i(1),Z=te(()=>Math.ceil(y.value.length/L)||1),oe=te(()=>{const l=(m.value-1)*L;return y.value.slice(l,l+L)}),x=l=>Y.find(e=>e.key===l)?.value,ce={格物修身:"purple",济世情怀:"indigo",道德情操:"sky",人与自然:"cyan",哲理思辨:"emerald",文化传承:"lime",理想信念:"amber",成长成才:"orange",家国情怀:"red"};function ie(l){const e=ce[l]??"gray",c=_.value.includes(l);return`tag-btn tag-cat-${e}-${c?"selected":"default"}`}const re={诗:"blue",词:"violet",曲:"pink",赋:"orange",文:"emerald"};function ee(l){return re[l]??"sky"}function ue(l){const e=ee(l),c=K(l),v=c.filter(T=>b.value.includes(T));let w="default";return v.length===c.length?w="full":v.length>0&&(w="partial"),`genre-main-btn genre-${e} genre-main-${w}`}function de(l){let e="";for(const[w,T]of Object.entries(G))if(T.includes(l)){e=w;break}const c=ee(e),v=b.value.includes(l);return`genre-sub-btn genre-${c} ${v?"genre-sub-selected":""}`}function K(l){return(G[l]??[]).filter(c=>(I[c]??0)>0)}function ve(l){const e=l.categories;return e?(Array.isArray(e)?e:String(e).split(",").map(v=>v.trim())).slice(0,2):[]}const ge={格物修身:"cat-purple",济世情怀:"cat-indigo",道德情操:"cat-sky",人与自然:"cat-cyan",哲理思辨:"cat-emerald",文化传承:"cat-lime",理想信念:"cat-amber",成长成才:"cat-orange",家国情怀:"cat-red"};function pe(l){return ge[l.trim()]??"cat-gray"}function ye(){_.value=[],C()}function _e(l){if(!U.value){if(N.value){const e=_.value.indexOf(l);e>-1?_.value.splice(e,1):_.value.push(l)}else _.value=_.value.includes(l)?[]:[l];C()}}function be(l){if(S.value)return;const e=K(l);if(e.length===0)return;e.every(v=>b.value.includes(v))?b.value=[]:b.value=[...e],C()}function fe(l){S.value||(b.value=b.value.includes(l)?[]:[l],C())}function ke(l){q.value||(A.value=A.value.includes(l)?[]:[l],C())}function he(l){E.value||(D.value=D.value.includes(l)?[]:[l],C())}async function C(){$.value=!0;try{const l=await Me({categories:[..._.value],authors:[...D.value],dynasties:[...A.value],genres:[...b.value]});y.value=l??[],m.value=1}finally{$.value=!1}}return we(m,()=>{Oe(()=>{window.scrollTo({top:0,behavior:"smooth"})})}),Se(()=>{Te()?.name!=="ClassicItemDetail"&&C()}),(l,e)=>{const c=F("el-icon"),v=F("el-pagination"),w=F("router-link"),T=F("el-empty");return a(),n("div",Be,[e[13]||(e[13]=s("div",{class:"page-bg"},null,-1)),s("div",Ge,[s("aside",Ae,[s("div",De,[s("div",Ne,[s("div",Ve,[e[6]||(e[6]=s("h3",{class:"filter-controls-title"},"主题标签",-1)),s("div",je,[s("button",{type:"button",class:g(["btn-multi",{active:N.value}]),onClick:e[0]||(e[0]=t=>N.value=!N.value)}," 多选 ",2),s("button",{type:"button",class:"btn-clear",onClick:ye},"清空")])]),s("div",ze,[(a(!0),n(d,null,f(k(P),t=>(a(),n("button",{key:t,type:"button",class:g(["tag-btn",[ie(t),{"tag-btn-locked":U.value}]]),disabled:U.value,onClick:r=>_e(t)},[s("span",null,o(t),1),s("span",Pe,o(J[t]??0),1)],10,Fe))),128))])]),s("div",Ie,[s("button",{type:"button",class:"collapsible-head",onClick:e[1]||(e[1]=t=>V.value=!V.value)},[e[7]||(e[7]=s("h3",{class:"collapsible-title"},"体裁分类",-1)),u(c,{class:g(["collapsible-icon",{rotate:V.value}])},{default:h(()=>[u(k(W))]),_:1},8,["class"])]),u(R,{name:"collapse"},{default:h(()=>[X(s("div",Ue,[s("div",qe,[(a(!0),n(d,null,f(k(ne),t=>(a(),n("div",{key:t,class:"genre-group"},[s("button",{type:"button",class:g(["genre-main-btn",[ue(t),{"tag-btn-locked":S.value}]]),disabled:S.value,onClick:r=>be(t)},[s("span",null,o(t),1),s("span",Ke,o(ae[t]??0),1)],10,Ee),s("div",Re,[(a(!0),n(d,null,f(K(t),r=>(a(),n("button",{key:r,type:"button",class:g(["genre-sub-btn",[de(r),{"tag-btn-locked":S.value}]]),disabled:S.value,onClick:Tt=>fe(r)},[s("span",null,o(r),1),s("span",Xe,o(I[r]??0),1)],10,We))),128))])]))),128))])],512),[[H,V.value]])]),_:1})]),s("div",He,[s("button",{type:"button",class:"collapsible-head",onClick:e[2]||(e[2]=t=>j.value=!j.value)},[e[8]||(e[8]=s("h3",{class:"collapsible-title"},"朝代筛选",-1)),u(c,{class:g(["collapsible-icon",{rotate:j.value}])},{default:h(()=>[u(k(W))]),_:1},8,["class"])]),u(R,{name:"collapse"},{default:h(()=>[X(s("div",Je,[s("div",Qe,[(a(!0),n(d,null,f(k(se),t=>(a(),n("button",{key:t,type:"button",class:g(["dynasty-btn",{active:A.value.includes(t),"tag-btn-locked":q.value}]),disabled:q.value,onClick:r=>ke(t)},[s("span",null,o(t),1),s("span",Ze,o(Q[t]??0),1)],10,Ye))),128))])],512),[[H,j.value]])]),_:1})]),s("div",et,[s("button",{type:"button",class:"collapsible-head",onClick:e[3]||(e[3]=t=>z.value=!z.value)},[e[9]||(e[9]=s("h3",{class:"collapsible-title"},"作者筛选",-1)),u(c,{class:g(["collapsible-icon",{rotate:z.value}])},{default:h(()=>[u(k(W))]),_:1},8,["class"])]),u(R,{name:"collapse"},{default:h(()=>[X(s("div",tt,[s("div",st,[(a(!0),n(d,null,f(k(le),t=>(a(),n("button",{key:t,type:"button",class:g(["author-btn",{active:D.value.includes(t),"tag-btn-locked":E.value}]),disabled:E.value,onClick:r=>he(t)},[s("span",null,o(t),1),s("span",at,o(B[t]??0),1)],10,lt))),128))])],512),[[H,z.value]])]),_:1})])]),s("div",nt,[s("div",ot,[(a(!0),n(d,null,f(Y,t=>(a(),n("div",{key:t.key,class:"display-toggle-row",onClick:r=>t.value=!t.value},[s("span",it,o(t.label),1),s("div",{class:g(["display-switch",{checked:t.value}])},[...e[10]||(e[10]=[s("div",{class:"display-switch-handle"},null,-1)])],2)],8,ct))),128))])])]),s("main",rt,[!$.value&&y.value.length>0&&Z.value>1?(a(),n("div",ut,[u(v,{"current-page":m.value,"onUpdate:currentPage":e[4]||(e[4]=t=>m.value=t),"page-size":L,total:y.value.length,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):p("",!0),!$.value&&y.value.length>0?(a(),n("div",dt,[(a(!0),n(d,null,f(oe.value,t=>(a(),$e(w,{key:t.id,to:`/classic/item/${t.id}`,class:"item-card"},{default:h(()=>[s("div",vt,[x("original")?(a(),n("h3",gt,o(t.original_text),1)):p("",!0),x("translation")&&t.translation?(a(),n("div",pt,[s("p",yt,[e[11]||(e[11]=s("b",null,"翻译：",-1)),O(o(t.translation),1)])])):p("",!0),s("div",_t,[s("span",bt,[x("dynasty")&&t.dynasty?(a(),n(d,{key:0},[O("［"+o(t.dynasty)+"］",1)],64)):p("",!0),x("author")&&t.author?(a(),n(d,{key:1},[O(o(t.author),1)],64)):p("",!0),x("author")&&t.author&&t.source?(a(),n(d,{key:2},[O(" · ")],64)):p("",!0),t.source?(a(),n(d,{key:3},[O(o(t.source),1)],64)):p("",!0),x("style")&&t.genre?(a(),n("span",ft,o(t.genre),1)):p("",!0)]),s("div",kt,[s("span",ht,[e[12]||(e[12]=s("span",{class:"icon-heart"},null,-1)),O(" "+o(t.likes??0),1)]),(a(!0),n(d,null,f(ve(t),r=>(a(),n("span",{key:r,class:g(["category-tag",pe(r)])},o(r),3))),128))])])])]),_:2},1032,["to"]))),128))])):p("",!0),$.value?(a(),n("div",mt,[u(c,{class:"is-loading",size:32,color:"#999"},{default:h(()=>[u(k(xe))]),_:1})])):y.value.length===0?(a(),n("div",Ct,[u(T,{description:"未找到相关素材，请调整筛选条件"})])):p("",!0),!$.value&&y.value.length>0&&Z.value>1?(a(),n("div",wt,[u(v,{"current-page":m.value,"onUpdate:currentPage":e[5]||(e[5]=t=>m.value=t),"page-size":L,total:y.value.length,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):p("",!0)])])])}}}),Bt=Le(St,[["__scopeId","data-v-da4c0ddd"]]);export{Bt as default};
//# sourceMappingURL=Browse-D1w09pBM.js.map
