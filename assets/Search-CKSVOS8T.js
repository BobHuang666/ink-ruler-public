import{d as E,l,J as m,C as J,Q as A,a0 as L,c as s,a as n,e as _,w as f,y as $,r as v,b as c,D as r,F as i,x as B,g as d,f as G,a1 as H,o as t,j as O,a2 as W,P as X,a3 as Y,_ as Z}from"./index-Ce45WVGD.js";import{s as ee}from"./classic-CFnwBeaU.js";const ae={class:"classic-search-page"},te={class:"search-inner"},se={class:"search-bar"},oe={class:"search-content"},ne={key:0,class:"result-header"},re={key:1,class:"loading-wrap"},le={key:2,class:"empty"},ce={key:0,class:"pagination-wrap pagination-top"},ue={class:"list-wrap"},ie={class:"card-inner"},de={class:"card-original"},pe={key:0,class:"card-trans-wrap"},_e={class:"card-trans"},ve={class:"card-footer"},ge={class:"card-meta"},ye={key:4,class:"card-genre"},he={class:"card-right"},me={class:"card-likes"},fe={key:1,class:"pagination-wrap"},g=20,ke=E({name:"ClassicSearch",__name:"Search",setup(we){const S=J(),y=l(""),V=l(""),p=l([]),k=l(!1),w=l(!1),D=l(!0),q=l(!0),F=l(!0),u=l(1),Q=m(()=>S.query.q??""),h=m(()=>p.value.length),z=m(()=>Math.ceil(h.value/g)||1),I=m(()=>{const o=(u.value-1)*g;return p.value.slice(o,o+g)}),U={格物修身:"cat-purple",济世情怀:"cat-indigo",道德情操:"cat-sky",人与自然:"cat-cyan",哲理思辨:"cat-emerald",文化传承:"cat-lime",理想信念:"cat-amber",成长成才:"cat-orange",家国情怀:"cat-red"};function K(o){const a=o.categories;return a?(Array.isArray(a)?a:String(a).split(",").map(b=>b.trim())).slice(0,2):[]}function M(o){return U[o.trim()]??"cat-gray"}async function C(){const o=y.value?.trim();if(o){V.value=o,k.value=!0,w.value=!0;try{const a=await ee(o,"keyword");p.value=a??[],u.value=1}finally{k.value=!1}}}function P(){const o=Q.value;o&&(y.value=o,C())}return A(()=>S.query.q,P),A(u,()=>{X(()=>{window.scrollTo({top:0,behavior:"smooth"})})}),L(()=>{Y()?.name!=="ClassicItemDetail"&&P()}),(o,a)=>{const T=v("el-button"),b=v("el-input"),R=v("el-icon"),N=v("el-pagination"),j=v("router-link");return t(),s("div",ae,[n("div",te,[n("div",se,[_(b,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e),placeholder:"输入关键词搜索",size:"large",clearable:"",class:"input",onKeyup:$(C,["enter"])},{append:f(()=>[_(T,{type:"primary",onClick:C},{default:f(()=>[...a[3]||(a[3]=[d("搜索",-1)])]),_:1})]),_:1},8,["modelValue"])]),n("div",oe,[w.value?(t(),s("div",ne,[n("span",null,"“"+r(V.value)+"” 共 "+r(h.value)+" 条",1)])):c("",!0),k.value?(t(),s("div",re,[_(R,{class:"is-loading",size:32},{default:f(()=>[_(G(H))]),_:1})])):w.value&&p.value.length===0?(t(),s("div",le,"暂无结果")):(t(),s(i,{key:3},[p.value.length>0&&z.value>1?(t(),s("div",ce,[_(N,{"current-page":u.value,"onUpdate:currentPage":a[1]||(a[1]=e=>u.value=e),"page-size":g,total:h.value,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):c("",!0),n("div",ue,[(t(!0),s(i,null,B(I.value,e=>(t(),O(j,{key:e.id,to:`/classic/item/${e.id}`,class:"item-card"},{default:f(()=>[n("div",ie,[n("h3",de,r(e.original_text),1),D.value&&e.translation?(t(),s("div",pe,[n("p",_e,[a[4]||(a[4]=n("b",null,"翻译：",-1)),d(r(e.translation),1)])])):c("",!0),n("div",ve,[n("span",ge,[F.value&&e.dynasty?(t(),s(i,{key:0},[d("［"+r(e.dynasty)+"］",1)],64)):c("",!0),q.value&&e.author?(t(),s(i,{key:1},[d(r(e.author),1)],64)):c("",!0),q.value&&e.author&&e.source?(t(),s(i,{key:2},[d(" · ")],64)):c("",!0),e.source?(t(),s(i,{key:3},[d(r(e.source),1)],64)):c("",!0),e.genre?(t(),s("span",ye,r(e.genre),1)):c("",!0)]),n("div",he,[n("span",me,[a[5]||(a[5]=n("span",{class:"icon-heart"},null,-1)),d(" "+r(e.likes??0),1)]),(t(!0),s(i,null,B(K(e),x=>(t(),s("span",{key:x,class:W(["category-tag",M(x)])},r(x),3))),128))])])])]),_:2},1032,["to"]))),128))]),p.value.length>0&&z.value>1?(t(),s("div",fe,[_(N,{"current-page":u.value,"onUpdate:currentPage":a[2]||(a[2]=e=>u.value=e),"page-size":g,total:h.value,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):c("",!0)],64))])])])}}}),xe=Z(ke,[["__scopeId","data-v-6af0cec2"]]);export{xe as default};
//# sourceMappingURL=Search-CKSVOS8T.js.map
