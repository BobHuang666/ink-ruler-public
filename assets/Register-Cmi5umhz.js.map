{"version":3,"file":"Register-Cmi5umhz.js","sources":["../../src/views/auth/Register.vue"],"sourcesContent":["<template>\n  <div class=\"register-page\">\n    <div class=\"register-container\">\n      <el-card class=\"register-card\" shadow=\"always\">\n        <template #header>\n          <div class=\"card-header\">\n            <h2 class=\"header-font\">注册</h2>\n            <p class=\"subtitle content-font\">创建你的账号</p>\n          </div>\n        </template>\n\n        <el-form\n          ref=\"formRef\"\n          :model=\"form\"\n          :rules=\"rules\"\n          label-width=\"0\"\n          @submit.prevent=\"handleRegister\"\n        >\n          <el-form-item prop=\"email\">\n            <el-input v-model=\"form.email\" placeholder=\"邮箱\" size=\"large\" :prefix-icon=\"Message\" />\n          </el-form-item>\n\n          <el-form-item prop=\"phone\">\n            <el-input\n              v-model=\"form.phone\"\n              placeholder=\"手机号（可选）\"\n              size=\"large\"\n              :prefix-icon=\"Phone\"\n            />\n          </el-form-item>\n\n          <el-form-item prop=\"nickname\">\n            <el-input v-model=\"form.nickname\" placeholder=\"昵称\" size=\"large\" :prefix-icon=\"User\" />\n          </el-form-item>\n\n          <el-form-item prop=\"password\">\n            <el-input\n              v-model=\"form.password\"\n              type=\"password\"\n              placeholder=\"密码（至少6位）\"\n              size=\"large\"\n              :prefix-icon=\"Lock\"\n              show-password\n            />\n          </el-form-item>\n\n          <el-form-item prop=\"confirmPassword\">\n            <el-input\n              v-model=\"form.confirmPassword\"\n              type=\"password\"\n              placeholder=\"确认密码\"\n              size=\"large\"\n              :prefix-icon=\"Lock\"\n              show-password\n              @keyup.enter=\"handleRegister\"\n            />\n          </el-form-item>\n\n          <el-form-item prop=\"agreement\" class=\"agreement-item\">\n            <el-checkbox v-model=\"form.agreement\">\n              我已阅读并同意\n              <el-link type=\"primary\" :underline=\"false\">《服务条款》</el-link>\n              和\n              <el-link type=\"primary\" :underline=\"false\">《隐私政策》</el-link>\n            </el-checkbox>\n          </el-form-item>\n\n          <el-form-item>\n            <el-button\n              type=\"primary\"\n              size=\"large\"\n              :loading=\"loading\"\n              class=\"register-button\"\n              @click=\"handleRegister\"\n            >\n              注册\n            </el-button>\n          </el-form-item>\n\n          <el-divider>或</el-divider>\n\n          <el-form-item>\n            <el-button size=\"large\" class=\"login-button\" @click=\"$router.push('/login')\">\n              已有账号？登录\n            </el-button>\n          </el-form-item>\n        </el-form>\n      </el-card>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useAuthStore } from '@/stores/auth'\nimport { Message, Phone, User, Lock } from '@element-plus/icons-vue'\nimport { ElMessage, type FormInstance, type FormRules } from 'element-plus'\n\nconst router = useRouter()\nconst authStore = useAuthStore()\n\nconst formRef = ref<FormInstance>()\nconst loading = ref(false)\n\nconst form = reactive({\n  email: '',\n  phone: '',\n  nickname: '',\n  password: '',\n  confirmPassword: '',\n  agreement: false,\n})\n\nconst validateConfirmPassword = (\n  _rule: unknown,\n  value: string,\n  callback: (error?: Error) => void\n) => {\n  if (value !== form.password) {\n    callback(new Error('两次输入的密码不一致'))\n  } else {\n    callback()\n  }\n}\n\nconst validateAgreement = (_rule: unknown, value: boolean, callback: (error?: Error) => void) => {\n  if (!value) {\n    callback(new Error('请先同意服务条款'))\n  } else {\n    callback()\n  }\n}\n\n// 中国大陆 11 位手机号：1 开头，第二位 3-9；不填则不校验\nconst validatePhone = (_rule: unknown, value: string, callback: (error?: Error) => void) => {\n  if (!value || !value.trim()) {\n    callback()\n    return\n  }\n  if (!/^1[3-9]\\d{9}$/.test(value.trim())) {\n    callback(new Error('请输入正确的手机号格式'))\n  } else {\n    callback()\n  }\n}\n\nconst rules: FormRules = {\n  email: [\n    { required: true, message: '请输入邮箱', trigger: 'blur' },\n    { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' },\n  ],\n  phone: [{ validator: validatePhone, trigger: 'blur' }],\n  nickname: [\n    { required: true, message: '请输入昵称', trigger: 'blur' },\n    { min: 2, max: 20, message: '昵称长度在2到20个字符', trigger: 'blur' },\n  ],\n  password: [\n    { required: true, message: '请输入密码', trigger: 'blur' },\n    { min: 6, message: '密码长度不能少于6位', trigger: 'blur' },\n  ],\n  confirmPassword: [\n    { required: true, message: '请确认密码', trigger: 'blur' },\n    { validator: validateConfirmPassword, trigger: 'blur' },\n  ],\n  agreement: [{ validator: validateAgreement, trigger: 'change' }],\n}\n\nasync function handleRegister() {\n  if (!formRef.value) return\n\n  await formRef.value.validate(async (valid) => {\n    if (valid) {\n      loading.value = true\n      try {\n        await authStore.register({\n          email: form.email,\n          phone: form.phone || undefined,\n          password: form.password,\n          nickname: form.nickname,\n        })\n        ElMessage.success('注册成功，请登录')\n        router.push('/login')\n      } catch (error: unknown) {\n        ElMessage.error((error as Error).message || '注册失败')\n      } finally {\n        loading.value = false\n      }\n    }\n  })\n}\n</script>\n\n<style scoped>\n.register-page {\n  min-height: calc(100vh - var(--header-height) - 80px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: var(--spacing-lg);\n  background: transparent;\n}\n\n.register-container {\n  width: 100%;\n  max-width: 420px;\n}\n\n.register-card {\n  border-radius: var(--border-radius-large);\n  box-shadow: var(--card-shadow);\n  border-color: var(--border-color-lighter);\n}\n\n.card-header {\n  text-align: center;\n}\n\n.card-header h2 {\n  font-size: var(--font-size-xxl);\n  font-weight: 600;\n  margin-bottom: var(--spacing-xs);\n  color: var(--color-text-primary);\n}\n\n.subtitle {\n  color: var(--color-text-secondary);\n  font-size: var(--font-size-sm);\n}\n\n.register-button {\n  width: 100%;\n}\n\n.login-button {\n  width: 100%;\n}\n\n/* 协议项：文案可换行，与错误提示留出间隙 */\n.register-card :deep(.agreement-item .el-form-item__content) {\n  min-width: 0;\n  flex-wrap: wrap;\n  margin-bottom: 0;\n  padding-bottom: 4px;\n}\n.register-card :deep(.agreement-item .el-checkbox) {\n  align-items: flex-start;\n}\n.register-card :deep(.agreement-item .el-checkbox__label) {\n  white-space: normal;\n  word-break: break-word;\n  line-height: 1.5;\n}\n/* 错误提示改为文档流，与文案留足间距（单行/两行都不遮挡） */\n.register-card :deep(.agreement-item .el-form-item__error) {\n  position: static;\n  margin-top: 10px;\n  margin-bottom: 0;\n  padding-top: 0;\n}\n</style>\n"],"names":["router","useRouter","authStore","useAuthStore","formRef","ref","loading","form","reactive","rules","_rule","value","callback","handleRegister","valid","ElMessage","error","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_card","_cache","_component_el_form","_component_el_form_item","_component_el_input","$event","_unref","Message","Phone","User","Lock","_component_el_checkbox","_component_el_link","_component_el_button","_component_el_divider","$router"],"mappings":"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"}