import{d as Se,l as Te,k as c,K as ae,R as ne,a8 as je,c as n,a as s,a2 as f,F as g,x,f as $,e as i,w as v,r as L,T as H,b as m,y as oe,t as u,S as J,q as Q,v as Z,g as b,N as Le,a9 as Ne,o as a,X as Ve,aa as ze,_ as Ae}from"./index-FlaK8epA.js";import{b as Be}from"./classic-MDaJyvZ_.js";const Pe={class:"classic-browse-page"},Ge={class:"browse-inner"},Fe={class:"sidebar"},Re={class:"filter-section-wrap"},De={class:"filter-block"},Ie={class:"filter-controls"},Ke={class:"filter-controls-actions"},Ue={class:"tags-grid-2"},Ee=["disabled","onClick"],We={class:"tag-btn-count"},Ye={class:"collapsible border-t pt-4 mt-4"},qe={class:"collapsible-body"},Xe={class:"genre-space"},He=["disabled","onClick"],Je={class:"tag-btn-count"},Qe={class:"genre-sub-grid"},Ze=["disabled","onClick"],et={class:"tag-btn-count"},tt={class:"collapsible border-t pt-4 mt-4"},st={class:"collapsible-body"},lt={class:"filter-grid-3"},at=["disabled","onClick"],nt={class:"tag-btn-count"},ot={class:"collapsible border-t pt-4 mt-4"},it={class:"collapsible-body"},ut={class:"filter-grid-3"},rt=["disabled","onClick"],ct={class:"tag-btn-count"},dt={class:"display-settings-wrap"},vt={class:"display-settings-grid"},pt=["onClick"],gt={class:"display-toggle-label"},bt={class:"main-content"},yt={class:"pagination-desktop"},_t={class:"pagination-mobile"},ft={class:"pagination-jump"},mt={class:"pagination-jump-label"},kt={key:1,class:"grid-wrap"},ht={class:"card-inner"},Ct={key:0,class:"card-original"},wt={key:1,class:"card-trans-wrap"},xt={class:"card-trans"},$t={class:"card-footer"},Mt={class:"card-meta"},Ot={key:4,class:"card-genre"},St={class:"card-right"},Tt={class:"card-likes"},jt={key:2,class:"loading-wrap"},Lt={key:3,class:"empty-placeholder"},Nt={key:4,class:"pagination-wrap"},Vt={class:"pagination-desktop"},zt={class:"pagination-mobile"},At={class:"pagination-jump"},Bt={class:"pagination-jump-label"},N=15,Pt=768,Gt=64,Ft=Se({name:"ClassicBrowse",__name:"Browse",setup(Rt){const ee={格物修身:270,成长成才:185,道德情操:339,哲理思辨:593,济世情怀:67,理想信念:778,文化传承:118,人与自然:313,家国情怀:126},K=Object.keys(ee),te={三国:63,先秦:100,南北朝:36,唐:757,宋:593,明:504,晋:77,汉:26},V=["先秦","汉","三国","晋","南北朝","隋","唐","五代","宋","辽","金","元","明","清","近现代"],ie=[...Object.keys(te)].sort((l,e)=>(V.indexOf(l)>=0?V.indexOf(l):999)-(V.indexOf(e)>=0?V.indexOf(e):999)),z={刘知几:4,卢照邻:16,周敦颐:11,孔子:100,孟浩然:34,崔颢:11,嵇康:1,左思:15,张旭:3,张载:32,文天祥:22,曹丕:21,曹操:26,曹植:25,曾巩:18,朱熹:26,李清照:13,李白:134,李邕:1,杜甫:353,杨炯:15,梅尧臣:4,欧阳修:13,王之涣:2,王安石:27,王昌龄:48,王绩:67,程颐:14,程颢:11,苏洵:18,苏轼:59,苏辙:26,谢朓:8,谢灵运:11,辛弃疾:276,阮籍:18,陆绍珩:504,陶渊明:60,骆宾王:24,高适:45,鲍照:17,黄庭坚:23},ue=[...Object.keys(z)].sort((l,e)=>(z[e]??0)-(z[l]??0)),A={诗:["七言律诗","七言排律","七言歌行","七言绝句","乐府诗","五言律诗","五言排律","五言绝句","古体诗"],词:["词"],曲:["曲"],赋:["赋"],文:["书","书启","对策","序","文","碑文","表奏","记","论","语录"]},U={语录:604,五言律诗:255,七言律诗:87,五言绝句:35,七言绝句:100,古体诗:457,词:227,论:35,文:166,五言排律:109,七言排律:2,乐府诗:9,记:28,书:12,序:9,七言歌行:2,书启:8,赋:1,表奏:3,对策:1,碑文:6},re={文:872,诗:1056,词:227,赋:1},ce=Object.keys(A).filter(l=>(A[l]??[]).some(e=>(U[e]??0)>0)),se=Te([{key:"original",label:"原文",value:!0},{key:"translation",label:"译文",value:!0},{key:"author",label:"作者",value:!0},{key:"dynasty",label:"朝代",value:!0},{key:"style",label:"体裁",value:!1},{key:"example",label:"范文",value:!1}]),h=c(K.length>0?[K[0]]:[]),B=c([]),P=c([]),C=c([]),G=c(!1),E=c(!1),O=c(!1),W=c(!1),Y=c(!1),F=c(!1),R=c(!1),D=c(!1),k=c([]),S=c(!1),o=c(1),y=ae(()=>Math.ceil(k.value.length/N)||1),de=ae(()=>{const l=(o.value-1)*N;return k.value.slice(l,l+N)}),w=c(1);ne(o,l=>{w.value=l},{immediate:!0});function I(){const l=Number(w.value);if(!Number.isFinite(l)||l<1){o.value=1,w.value=1;return}const e=y.value,r=Math.min(e,Math.max(1,Math.floor(l)));o.value=r,w.value=r}const T=l=>se.find(e=>e.key===l)?.value,ve={格物修身:"purple",济世情怀:"indigo",道德情操:"sky",人与自然:"cyan",哲理思辨:"emerald",文化传承:"lime",理想信念:"amber",成长成才:"orange",家国情怀:"red"};function pe(l){const e=ve[l]??"gray",r=h.value.includes(l);return`tag-btn tag-cat-${e}-${r?"selected":"default"}`}const ge={诗:"blue",词:"violet",曲:"pink",赋:"orange",文:"emerald"};function le(l){return ge[l]??"sky"}function be(l){const e=le(l),r=q(l),_=r.filter(j=>C.value.includes(j));let p="default";return _.length===r.length?p="full":_.length>0&&(p="partial"),`genre-main-btn genre-${e} genre-main-${p}`}function ye(l){let e="";for(const[p,j]of Object.entries(A))if(j.includes(l)){e=p;break}const r=le(e),_=C.value.includes(l);return`genre-sub-btn genre-${r} ${_?"genre-sub-selected":""}`}function q(l){return(A[l]??[]).filter(r=>(U[r]??0)>0)}function _e(l){const e=l.categories;return e?(Array.isArray(e)?e:String(e).split(",").map(_=>_.trim())).slice(0,2):[]}const fe={格物修身:"cat-purple",济世情怀:"cat-indigo",道德情操:"cat-sky",人与自然:"cat-cyan",哲理思辨:"cat-emerald",文化传承:"cat-lime",理想信念:"cat-amber",成长成才:"cat-orange",家国情怀:"cat-red"};function me(l){return fe[l.trim()]??"cat-gray"}function ke(){h.value=[],M()}function he(l){if(!E.value){if(G.value){const e=h.value.indexOf(l);e>-1?h.value.splice(e,1):h.value.push(l)}else h.value=h.value.includes(l)?[]:[l];M()}}function Ce(l){if(O.value)return;const e=q(l);if(e.length===0)return;e.every(_=>C.value.includes(_))?C.value=[]:C.value=[...e],M()}function we(l){O.value||(C.value=C.value.includes(l)?[]:[l],M())}function xe(l){W.value||(B.value=B.value.includes(l)?[]:[l],M())}function $e(l){Y.value||(P.value=P.value.includes(l)?[]:[l],M())}async function M(){S.value=!0;try{const l=await Be({categories:[...h.value],authors:[...P.value],dynasties:[...B.value],genres:[...C.value]});k.value=l??[],o.value=1}finally{S.value=!1}}const X=c(null);return ne(o,()=>{Ve(()=>{if(window.innerWidth<=Pt&&X.value){const e=X.value.getBoundingClientRect(),r=window.scrollY+e.top-Gt;window.scrollTo({top:Math.max(0,r),behavior:"smooth"})}else window.scrollTo({top:0,behavior:"smooth"})})}),je(()=>{ze()?.name!=="ClassicItemDetail"&&M()}),(l,e)=>{const r=L("el-icon"),_=L("el-pagination"),p=L("el-button"),j=L("el-input"),Me=L("router-link"),Oe=L("el-empty");return a(),n("div",Pe,[e[27]||(e[27]=s("div",{class:"page-bg"},null,-1)),s("div",Ge,[s("aside",Fe,[s("div",Re,[s("div",De,[s("div",Ie,[e[12]||(e[12]=s("h3",{class:"filter-controls-title"},"主题标签",-1)),s("div",Ke,[s("button",{type:"button",class:f(["btn-multi",{active:G.value}]),onClick:e[0]||(e[0]=t=>G.value=!G.value)}," 多选 ",2),s("button",{type:"button",class:"btn-clear",onClick:ke},"清空")])]),s("div",Ue,[(a(!0),n(g,null,x($(K),t=>(a(),n("button",{key:t,type:"button",class:f(["tag-btn",[pe(t),{"tag-btn-locked":E.value}]]),disabled:E.value,onClick:d=>he(t)},[s("span",null,u(t),1),s("span",We,u(ee[t]??0),1)],10,Ee))),128))])]),s("div",Ye,[s("button",{type:"button",class:"collapsible-head",onClick:e[1]||(e[1]=t=>F.value=!F.value)},[e[13]||(e[13]=s("h3",{class:"collapsible-title"},"体裁分类",-1)),i(r,{class:f(["collapsible-icon",{rotate:F.value}])},{default:v(()=>[i($(J))]),_:1},8,["class"])]),i(H,{name:"collapse"},{default:v(()=>[Q(s("div",qe,[s("div",Xe,[(a(!0),n(g,null,x($(ce),t=>(a(),n("div",{key:t,class:"genre-group"},[s("button",{type:"button",class:f(["genre-main-btn",[be(t),{"tag-btn-locked":O.value}]]),disabled:O.value,onClick:d=>Ce(t)},[s("span",null,u(t),1),s("span",Je,u(re[t]??0),1)],10,He),s("div",Qe,[(a(!0),n(g,null,x(q(t),d=>(a(),n("button",{key:d,type:"button",class:f(["genre-sub-btn",[ye(d),{"tag-btn-locked":O.value}]]),disabled:O.value,onClick:Kt=>we(d)},[s("span",null,u(d),1),s("span",et,u(U[d]??0),1)],10,Ze))),128))])]))),128))])],512),[[Z,F.value]])]),_:1})]),s("div",tt,[s("button",{type:"button",class:"collapsible-head",onClick:e[2]||(e[2]=t=>R.value=!R.value)},[e[14]||(e[14]=s("h3",{class:"collapsible-title"},"朝代筛选",-1)),i(r,{class:f(["collapsible-icon",{rotate:R.value}])},{default:v(()=>[i($(J))]),_:1},8,["class"])]),i(H,{name:"collapse"},{default:v(()=>[Q(s("div",st,[s("div",lt,[(a(!0),n(g,null,x($(ie),t=>(a(),n("button",{key:t,type:"button",class:f(["dynasty-btn",{active:B.value.includes(t),"tag-btn-locked":W.value}]),disabled:W.value,onClick:d=>xe(t)},[s("span",null,u(t),1),s("span",nt,u(te[t]??0),1)],10,at))),128))])],512),[[Z,R.value]])]),_:1})]),s("div",ot,[s("button",{type:"button",class:"collapsible-head",onClick:e[3]||(e[3]=t=>D.value=!D.value)},[e[15]||(e[15]=s("h3",{class:"collapsible-title"},"作者筛选",-1)),i(r,{class:f(["collapsible-icon",{rotate:D.value}])},{default:v(()=>[i($(J))]),_:1},8,["class"])]),i(H,{name:"collapse"},{default:v(()=>[Q(s("div",it,[s("div",ut,[(a(!0),n(g,null,x($(ue),t=>(a(),n("button",{key:t,type:"button",class:f(["author-btn",{active:P.value.includes(t),"tag-btn-locked":Y.value}]),disabled:Y.value,onClick:d=>$e(t)},[s("span",null,u(t),1),s("span",ct,u(z[t]??0),1)],10,rt))),128))])],512),[[Z,D.value]])]),_:1})])]),s("div",dt,[s("div",vt,[(a(!0),n(g,null,x(se,t=>(a(),n("div",{key:t.key,class:"display-toggle-row",onClick:d=>t.value=!t.value},[s("span",gt,u(t.label),1),s("div",{class:f(["display-switch",{checked:t.value}])},[...e[16]||(e[16]=[s("div",{class:"display-switch-handle"},null,-1)])],2)],8,pt))),128))])])]),s("main",bt,[!S.value&&k.value.length>0&&y.value>1?(a(),n("div",{key:0,ref_key:"topPaginationRef",ref:X,class:"pagination-wrap pagination-top"},[s("div",yt,[i(_,{"current-page":o.value,"onUpdate:currentPage":e[4]||(e[4]=t=>o.value=t),"page-size":N,total:k.value.length,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])]),s("div",_t,[i(p,{size:"small",disabled:o.value<=1,onClick:e[5]||(e[5]=t=>o.value=Math.max(1,o.value-1))},{default:v(()=>[...e[17]||(e[17]=[b(" 上一页 ",-1)])]),_:1},8,["disabled"]),s("span",ft,[e[19]||(e[19]=s("span",{class:"pagination-jump-label"},"第",-1)),i(j,{modelValue:w.value,"onUpdate:modelValue":e[6]||(e[6]=t=>w.value=t),modelModifiers:{number:!0},type:"number",min:"1",max:y.value,class:"pagination-jump-input",onKeyup:oe(I,["enter"])},null,8,["modelValue","max"]),s("span",mt,"页 / 共 "+u(y.value)+" 页",1),i(p,{size:"small",type:"primary",onClick:I},{default:v(()=>[...e[18]||(e[18]=[b("跳转",-1)])]),_:1})]),i(p,{size:"small",disabled:o.value>=y.value,onClick:e[7]||(e[7]=t=>o.value=Math.min(y.value,o.value+1))},{default:v(()=>[...e[20]||(e[20]=[b(" 下一页 ",-1)])]),_:1},8,["disabled"])])],512)):m("",!0),!S.value&&k.value.length>0?(a(),n("div",kt,[(a(!0),n(g,null,x(de.value,t=>(a(),Le(Me,{key:t.id,to:`/classic/item/${t.id}`,class:"item-card"},{default:v(()=>[s("div",ht,[T("original")?(a(),n("h3",Ct,u(t.original_text),1)):m("",!0),T("translation")&&t.translation?(a(),n("div",wt,[s("p",xt,[e[21]||(e[21]=s("b",null,"翻译：",-1)),b(u(t.translation),1)])])):m("",!0),s("div",$t,[s("span",Mt,[T("dynasty")&&t.dynasty?(a(),n(g,{key:0},[b("［"+u(t.dynasty)+"］",1)],64)):m("",!0),T("author")&&t.author?(a(),n(g,{key:1},[b(u(t.author),1)],64)):m("",!0),T("author")&&t.author&&t.source?(a(),n(g,{key:2},[b(" · ")],64)):m("",!0),t.source?(a(),n(g,{key:3},[b(u(t.source),1)],64)):m("",!0),T("style")&&t.genre?(a(),n("span",Ot,u(t.genre),1)):m("",!0)]),s("div",St,[s("span",Tt,[e[22]||(e[22]=s("span",{class:"icon-star"},null,-1)),b(" "+u(t.likes??0),1)]),(a(!0),n(g,null,x(_e(t),d=>(a(),n("span",{key:d,class:f(["category-tag",me(d)])},u(d),3))),128))])])])]),_:2},1032,["to"]))),128))])):m("",!0),S.value?(a(),n("div",jt,[i(r,{class:"is-loading",size:32,color:"#999"},{default:v(()=>[i($(Ne))]),_:1})])):k.value.length===0?(a(),n("div",Lt,[i(Oe,{description:"未找到相关素材，请调整筛选条件"})])):m("",!0),!S.value&&k.value.length>0&&y.value>1?(a(),n("div",Nt,[s("div",Vt,[i(_,{"current-page":o.value,"onUpdate:currentPage":e[8]||(e[8]=t=>o.value=t),"page-size":N,total:k.value.length,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])]),s("div",zt,[i(p,{size:"small",disabled:o.value<=1,onClick:e[9]||(e[9]=t=>o.value=Math.max(1,o.value-1))},{default:v(()=>[...e[23]||(e[23]=[b(" 上一页 ",-1)])]),_:1},8,["disabled"]),s("span",At,[e[25]||(e[25]=s("span",{class:"pagination-jump-label"},"第",-1)),i(j,{modelValue:w.value,"onUpdate:modelValue":e[10]||(e[10]=t=>w.value=t),modelModifiers:{number:!0},type:"number",min:"1",max:y.value,class:"pagination-jump-input",onKeyup:oe(I,["enter"])},null,8,["modelValue","max"]),s("span",Bt,"页 / 共 "+u(y.value)+" 页",1),i(p,{size:"small",type:"primary",onClick:I},{default:v(()=>[...e[24]||(e[24]=[b("跳转",-1)])]),_:1})]),i(p,{size:"small",disabled:o.value>=y.value,onClick:e[11]||(e[11]=t=>o.value=Math.min(y.value,o.value+1))},{default:v(()=>[...e[26]||(e[26]=[b(" 下一页 ",-1)])]),_:1},8,["disabled"])])])):m("",!0)])])])}}}),Wt=Ae(Ft,[["__scopeId","data-v-72ff395e"]]);export{Wt as default};
//# sourceMappingURL=Browse-CbYfrzKX.js.map
