{"version":3,"file":"All-DO_LLdUq.js","sources":["../../src/views/classic/All.vue"],"sourcesContent":["<template>\n  <div class=\"classic-all-page\">\n    <div class=\"page-bg\">\n      <div class=\"page-bg-gradient\" />\n    </div>\n    <div class=\"all-inner\">\n      <section class=\"header\">\n        <h1 class=\"title title-font\">句海漫游</h1>\n        <p class=\"subtitle content-font\">随机探索传统文化瑰宝</p>\n        <el-button v-if=\"items.length > 0\" type=\"primary\" :loading=\"loading\" @click=\"handleRefresh\"\n          >换一批</el-button\n        >\n      </section>\n      <section v-if=\"loading && items.length === 0\" class=\"loading-wrap\">\n        <el-icon class=\"is-loading\" :size=\"32\"><Loading /></el-icon>\n      </section>\n      <section v-else-if=\"items.length === 0 && !loading\" class=\"empty-wrap\">\n        <el-empty description=\"暂无素材，请稍后再试\">\n          <el-button type=\"primary\" @click=\"handleRefresh\">重新加载</el-button>\n        </el-empty>\n      </section>\n      <section v-else class=\"grid-wrap\">\n        <router-link\n          v-for=\"item in items\"\n          :key=\"item.id\"\n          :to=\"`/classic/item/${item.id}`\"\n          class=\"item-card\"\n        >\n          <div class=\"card-inner\">\n            <h3 class=\"card-original\">{{ item.original_text }}</h3>\n            <div class=\"card-footer\">\n              <span class=\"card-meta\">\n                <template v-if=\"item.dynasty\">［{{ item.dynasty }}］</template>\n                <template v-if=\"item.author\">{{ item.author }}</template>\n                <template v-if=\"item.author && item.source\"> · </template>\n                <template v-if=\"item.source\">{{ item.source }}</template>\n                <span v-if=\"item.genre\" class=\"card-genre\">{{ item.genre }}</span>\n              </span>\n              <div class=\"card-right\">\n                <span class=\"card-likes\">\n                  <span class=\"icon-heart\"></span>\n                  {{ item.likes ?? 0 }}\n                </span>\n                <template v-for=\"cat in itemCategories(item)\" :key=\"cat\">\n                  <span :class=\"['category-tag', getCategoryTagClass(cat)]\">{{ cat }}</span>\n                </template>\n              </div>\n            </div>\n          </div>\n        </router-link>\n      </section>\n      <section v-if=\"items.length > 0\" class=\"footer-actions\">\n        <el-button type=\"primary\" :loading=\"loading\" @click=\"handleRefresh\">换一批</el-button>\n      </section>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onActivated } from 'vue'\nimport { Loading } from '@element-plus/icons-vue'\nimport { all } from '@/api/classic'\nimport type { ClassicItem } from '@/types/classic'\nimport { getNavigationFrom } from '@/router'\n\ndefineOptions({ name: 'ClassicAll' })\n\nconst items = ref<ClassicItem[]>([])\nconst loading = ref(false)\n\nconst categoryTagMap: Record<string, string> = {\n  格物修身: 'cat-purple',\n  济世情怀: 'cat-indigo',\n  道德情操: 'cat-sky',\n  人与自然: 'cat-cyan',\n  哲理思辨: 'cat-emerald',\n  文化传承: 'cat-lime',\n  理想信念: 'cat-amber',\n  成长成才: 'cat-orange',\n  家国情怀: 'cat-red',\n}\nfunction itemCategories(item: ClassicItem): string[] {\n  const raw = item.categories\n  if (!raw) return []\n  const arr = Array.isArray(raw)\n    ? raw\n    : String(raw)\n        .split(',')\n        .map((s: string) => s.trim())\n  return arr.slice(0, 2)\n}\nfunction getCategoryTagClass(category: string): string {\n  return categoryTagMap[category.trim()] ?? 'cat-gray'\n}\n\nasync function fetchMore() {\n  loading.value = true\n  try {\n    const list = await all()\n    items.value = list ?? []\n  } finally {\n    loading.value = false\n  }\n}\n\nasync function handleRefresh() {\n  await fetchMore()\n  window.scrollTo({ top: 0, behavior: 'smooth' })\n}\n\nonActivated(() => {\n  // 从详情页返回时不刷新（与相似推荐一致），其他情况刷新\n  const from = getNavigationFrom()\n  const fromDetail = from?.name === 'ClassicItemDetail' || from?.path?.startsWith('/classic/item/')\n  if (fromDetail) return\n  fetchMore()\n})\n</script>\n\n<style scoped>\n.classic-all-page {\n  position: relative;\n  min-height: calc(100vh - var(--header-height) - 80px);\n}\n.page-bg {\n  position: absolute;\n  inset: 0;\n  z-index: -1;\n}\n.page-bg-gradient {\n  position: absolute;\n  inset: 0;\n  background: var(--page-bg-gradient);\n}\n.all-inner {\n  max-width: 64rem;\n  margin: 0 auto;\n  padding: 32px 16px;\n}\n.header {\n  text-align: center;\n  margin-bottom: 32px;\n}\n.title {\n  font-size: 2rem;\n  font-weight: 600;\n  margin-bottom: var(--spacing-sm);\n  color: var(--color-text-primary);\n}\n.subtitle {\n  font-size: var(--font-size-lg);\n  color: var(--color-text-regular);\n  margin-bottom: var(--spacing-md);\n}\n.loading-wrap {\n  display: flex;\n  justify-content: center;\n  padding: 48px;\n}\n.empty-wrap {\n  display: flex;\n  justify-content: center;\n  padding: 48px;\n}\n.grid-wrap {\n  column-count: auto;\n  column-width: 280px;\n  column-gap: 16px;\n  width: 100%;\n}\n.item-card {\n  display: inline-block;\n  width: 100%;\n  padding: 16px;\n  border-radius: 8px;\n  background: linear-gradient(\n    to bottom right,\n    rgba(255, 251, 235, 0.8),\n    rgba(255, 255, 255, 0.8),\n    rgba(239, 246, 255, 0.8)\n  );\n  backdrop-filter: blur(2px);\n  border: 1px solid rgba(231, 229, 228, 0.7);\n  text-decoration: none;\n  color: inherit;\n  transition: all 0.3s ease-in-out;\n  break-inside: avoid;\n  margin-bottom: 16px;\n  box-sizing: border-box;\n}\n.item-card:hover {\n  background: linear-gradient(\n    to bottom right,\n    rgba(254, 243, 199, 0.9),\n    rgba(255, 255, 255, 0.9),\n    rgba(219, 234, 254, 0.9)\n  );\n  box-shadow:\n    0 4px 6px -1px rgba(0, 0, 0, 0.1),\n    0 2px 4px -2px rgba(0, 0, 0, 0.1);\n}\n.card-inner {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.card-original {\n  font-size: 16px;\n  font-weight: 600;\n  line-height: 1.625;\n  color: #292524;\n  margin: 0;\n  font-family: 'SiYuanSongTi', 'Source Han Serif CN', 'SimSun', serif;\n}\n.card-footer {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  gap: 8px;\n}\n.card-meta {\n  font-size: 12px;\n  color: #78716c;\n  font-family: 'FZKT', 'KaiTi', 'STKaiti', serif;\n  word-wrap: break-word;\n  word-break: break-all;\n}\n.card-genre {\n  margin-left: 12px;\n  color: #a8a29e;\n  font-family: 'FZKT', 'KaiTi', 'STKaiti', serif;\n}\n.card-right {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 8px;\n  width: 100%;\n}\n.card-likes {\n  display: inline-flex;\n  align-items: center;\n  font-size: 12px;\n  color: #78716c;\n  font-family: 'SiYuanSongTi', 'Source Han Serif CN', 'SimSun', serif;\n}\n.icon-heart {\n  display: inline-block;\n  width: 14px;\n  height: 14px;\n  margin-right: 4px;\n  background: currentColor;\n  mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z'/%3E%3C/svg%3E\")\n    center/contain no-repeat;\n  -webkit-mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z'/%3E%3C/svg%3E\")\n    center/contain no-repeat;\n}\n.category-tag {\n  display: inline-flex;\n  align-items: center;\n  padding: 2px 6px;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 500;\n  font-family: 'FZKT', 'KaiTi', 'STKaiti', serif;\n}\n.cat-purple {\n  background: #faf5ff;\n  color: #6b21a8;\n}\n.cat-indigo {\n  background: #eef2ff;\n  color: #3730a3;\n}\n.cat-sky {\n  background: #f0f9ff;\n  color: #075985;\n}\n.cat-cyan {\n  background: #ecfeff;\n  color: #155e75;\n}\n.cat-emerald {\n  background: #ecfdf5;\n  color: #065f46;\n}\n.cat-lime {\n  background: #f7fee7;\n  color: #365314;\n}\n.cat-amber {\n  background: #fffbeb;\n  color: #92400e;\n}\n.cat-orange {\n  background: #fff7ed;\n  color: #9a3412;\n}\n.cat-red {\n  background: #fef2f2;\n  color: #991b1b;\n}\n.cat-gray {\n  background: #f9fafb;\n  color: #1f2937;\n}\n.footer-actions {\n  text-align: center;\n  margin-top: 40px;\n  padding-top: 24px;\n}\n</style>\n"],"names":["items","ref","loading","categoryTagMap","itemCategories","item","raw","s","getCategoryTagClass","category","fetchMore","list","all","handleRefresh","onActivated","from","getNavigationFrom","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","_createBlock","_component_el_button","_hoisted_4","_createVNode","_component_el_icon","_unref","Loading","_hoisted_5","_component_el_empty","_hoisted_6","_Fragment","_renderList","_component_router_link","_hoisted_7","_hoisted_8","_toDisplayString","_hoisted_9","_hoisted_10","_createTextVNode","_hoisted_11","_hoisted_12","_hoisted_13","cat","_normalizeClass","_hoisted_14"],"mappings":"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"}