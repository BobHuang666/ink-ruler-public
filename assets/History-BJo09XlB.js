import{d as R,u as T,B as F,v as j,c as h,a as _,e as s,w as o,r as i,D as I,b as v,F as L,f as d,j as k,g as a,A as y,n as m,o as u,E as c,C as q,_ as z}from"./index-DYibA2ZD.js";import{u as G}from"./essay-D67lxHTF.js";const J={class:"history-page"},K={class:"container"},O={class:"page-header"},P={key:0,class:"empty-state"},Q=R({__name:"History",setup(U){const f=j(),g=T(),l=G();F(async()=>{if(!g.isAuthenticated){f.push("/login");return}await l.fetchHistory()});function b(t){return{pending:"info",processing:"warning",done:"success",failed:"danger"}[t]||"info"}function C(t){return{pending:"待处理",processing:"处理中",done:"已完成",failed:"失败"}[t]||t}function x(t){f.push(`/essay/${t.id}`)}function $(t){f.push(`/essay/${t.id}`)}async function S(t){try{await l.favoriteEssay(t.id),c.success("收藏成功")}catch(e){c.error(e.message||"收藏失败")}}async function E(t){try{await q.confirm("确定要删除这条记录吗？","提示",{type:"warning"}),await l.deleteEssay(t.id),c.success("删除成功")}catch(e){e!=="cancel"&&c.error(e.message||"删除失败")}}return(t,e)=>{const B=i("el-link"),D=i("el-alert"),r=i("el-table-column"),M=i("el-tag"),p=i("el-button"),V=i("el-table"),N=i("el-empty"),A=i("el-card"),H=L("loading");return u(),h("div",J,[_("div",K,[s(A,{shadow:"never"},{header:o(()=>[_("div",O,[e[5]||(e[5]=_("h2",null,"历史记录",-1)),d(g).isMember?v("",!0):(u(),k(D,{key:0,title:"提示",type:"info",closable:!1,"show-icon":""},{default:o(()=>[e[3]||(e[3]=a(" 非会员用户仅保存30天记录，",-1)),s(B,{type:"primary",onClick:e[0]||(e[0]=n=>t.$router.push("/profile"))},{default:o(()=>[...e[2]||(e[2]=[a(" 升级会员 ",-1)])]),_:1}),e[4]||(e[4]=a(" 可永久保存 ",-1))]),_:1}))])]),default:o(()=>[I((u(),k(V,{data:d(l).history,style:{width:"100%"},onRowClick:x},{default:o(()=>[s(r,{prop:"title",label:"标题",width:"200"},{default:o(({row:n})=>[a(y(n.title||"无标题"),1)]),_:1}),s(r,{prop:"word_count",label:"字数",width:"100"}),s(r,{prop:"status",label:"状态",width:"120"},{default:o(({row:n})=>[s(M,{type:b(n.status)},{default:o(()=>[a(y(C(n.status)),1)]),_:2},1032,["type"])]),_:1}),s(r,{prop:"created_at",label:"提交时间",width:"180"},{default:o(({row:n})=>[a(y(new Date(n.created_at).toLocaleString()),1)]),_:1}),s(r,{label:"操作",width:"200",fixed:"right"},{default:o(({row:n})=>[s(p,{type:"primary",text:"",onClick:m(w=>$(n),["stop"])},{default:o(()=>[...e[6]||(e[6]=[a("查看",-1)])]),_:1},8,["onClick"]),s(p,{type:"success",text:"",onClick:m(w=>S(n),["stop"])},{default:o(()=>[...e[7]||(e[7]=[a("收藏",-1)])]),_:1},8,["onClick"]),s(p,{type:"danger",text:"",onClick:m(w=>E(n),["stop"])},{default:o(()=>[...e[8]||(e[8]=[a("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,d(l).loading]]),d(l).history.length===0&&!d(l).loading?(u(),h("div",P,[s(N,{description:"暂无历史记录"},{default:o(()=>[s(p,{type:"primary",onClick:e[1]||(e[1]=n=>t.$router.push("/essay/correction"))},{default:o(()=>[...e[9]||(e[9]=[a(" 开始批改 ",-1)])]),_:1})]),_:1})])):v("",!0)]),_:1})])])}}}),Y=z(Q,[["__scopeId","data-v-96a56f5b"]]);export{Y as default};
//# sourceMappingURL=History-BJo09XlB.js.map
