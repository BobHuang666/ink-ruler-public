import{d as E,u as q,k as c,l as I,G as S,c as A,a as n,e as r,w as a,r as i,p as B,f as m,H as N,g as p,t as K,I as M,s as T,z as x,y as D,A as G,E as f,J as H,o as J,_ as j}from"./index-FlaK8epA.js";const F={class:"register-page"},L={class:"register-container"},O={class:"email-code-row"},Q={class:"agreement-row"},W={class:"agreement-links"},X=E({name:"Register",__name:"Register",setup(Y){const v=G(),C=q(),_=c(),w=c(!1),y=c(!1),d=c(0);let g=null;const l=I({email:"",email_code:"",phone:"",nickname:"",password:"",confirmPassword:"",agreement:!1});async function h(){if(!l.email||d.value>0)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)){f.warning("请先输入正确邮箱");return}y.value=!0;try{await H(l.email),f.success("验证码已发送，请查收邮箱"),d.value=60,g=setInterval(()=>{d.value--,d.value<=0&&g&&(clearInterval(g),g=null)},1e3)}catch(e){f.error(e.message||"发送失败")}finally{y.value=!1}}S(()=>{g&&clearInterval(g)});const z={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],email_code:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"},{len:4,message:"验证码为 4 位数字",trigger:"blur"},{pattern:/^\d{4}$/,message:"验证码为 4 位数字",trigger:"blur"}],phone:[{validator:(u,e,o)=>{if(!e||!e.trim()){o();return}/^1[3-9]\d{9}$/.test(e.trim())?o():o(new Error("请输入正确的手机号格式"))},trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:20,message:"昵称长度在2到20个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(u,e,o)=>{e!==l.password?o(new Error("两次输入的密码不一致")):o()},trigger:"blur"}],agreement:[{validator:(u,e,o)=>{e?o():o(new Error("请先同意服务条款"))},trigger:"change"}]};async function V(){_.value&&await _.value.validate(async u=>{if(u){w.value=!0;try{await C.register({email:l.email,email_code:l.email_code,phone:l.phone||void 0,password:l.password,nickname:l.nickname}),f.success("注册成功，请登录"),v.push("/login")}catch(e){f.error(e.message||"注册失败")}finally{w.value=!1}}})}return(u,e)=>{const o=i("el-input"),t=i("el-form-item"),b=i("el-button"),P=i("el-checkbox"),k=i("el-link"),R=i("el-divider"),U=i("el-form"),$=i("el-card");return J(),A("div",F,[n("div",L,[r($,{class:"register-card",shadow:"always"},{header:a(()=>[...e[10]||(e[10]=[n("div",{class:"card-header"},[n("h2",{class:"header-font"},"注册"),n("p",{class:"subtitle content-font"},"创建你的账号")],-1)])]),default:a(()=>[r(U,{ref_key:"formRef",ref:_,model:l,rules:z,"label-width":"0",onSubmit:B(V,["prevent"])},{default:a(()=>[r(t,{prop:"email"},{default:a(()=>[r(o,{modelValue:l.email,"onUpdate:modelValue":e[0]||(e[0]=s=>l.email=s),placeholder:"邮箱",size:"large","prefix-icon":m(N)},null,8,["modelValue","prefix-icon"])]),_:1}),r(t,{prop:"email_code"},{default:a(()=>[n("div",O,[r(o,{modelValue:l.email_code,"onUpdate:modelValue":e[1]||(e[1]=s=>l.email_code=s),placeholder:"邮箱验证码（4位）",size:"large",maxlength:"4",class:"email-code-input"},null,8,["modelValue"]),r(b,{type:"primary",size:"large",disabled:d.value>0||!l.email,loading:y.value,class:"send-code-btn",onClick:h},{default:a(()=>[p(K(d.value>0?`${d.value}s 后重试`:"获取验证码"),1)]),_:1},8,["disabled","loading"])])]),_:1}),r(t,{prop:"phone"},{default:a(()=>[r(o,{modelValue:l.phone,"onUpdate:modelValue":e[2]||(e[2]=s=>l.phone=s),placeholder:"手机号（可选）",size:"large","prefix-icon":m(M)},null,8,["modelValue","prefix-icon"])]),_:1}),r(t,{prop:"nickname"},{default:a(()=>[r(o,{modelValue:l.nickname,"onUpdate:modelValue":e[3]||(e[3]=s=>l.nickname=s),placeholder:"昵称",size:"large","prefix-icon":m(T)},null,8,["modelValue","prefix-icon"])]),_:1}),r(t,{prop:"password"},{default:a(()=>[r(o,{modelValue:l.password,"onUpdate:modelValue":e[4]||(e[4]=s=>l.password=s),type:"password",placeholder:"密码（至少6位）",size:"large","prefix-icon":m(x),"show-password":""},null,8,["modelValue","prefix-icon"])]),_:1}),r(t,{prop:"confirmPassword"},{default:a(()=>[r(o,{modelValue:l.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=s=>l.confirmPassword=s),type:"password",placeholder:"确认密码",size:"large","prefix-icon":m(x),"show-password":"",onKeyup:D(V,["enter"])},null,8,["modelValue","prefix-icon"])]),_:1}),r(t,{prop:"agreement",class:"agreement-item"},{default:a(()=>[n("div",Q,[r(P,{modelValue:l.agreement,"onUpdate:modelValue":e[6]||(e[6]=s=>l.agreement=s)},{default:a(()=>[...e[11]||(e[11]=[p("我已阅读并同意",-1)])]),_:1},8,["modelValue"]),n("span",W,[r(k,{type:"primary",underline:"never",onClick:e[7]||(e[7]=s=>m(v).push("/terms"))},{default:a(()=>[...e[12]||(e[12]=[p(" 《服务条款》 ",-1)])]),_:1}),e[14]||(e[14]=n("span",{class:"agreement-and"},"和",-1)),r(k,{type:"primary",underline:"never",onClick:e[8]||(e[8]=s=>m(v).push("/privacy"))},{default:a(()=>[...e[13]||(e[13]=[p(" 《隐私政策》 ",-1)])]),_:1})])])]),_:1}),r(t,null,{default:a(()=>[r(b,{type:"primary",size:"large",loading:w.value,class:"register-button",onClick:V},{default:a(()=>[...e[15]||(e[15]=[p(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1}),r(R,null,{default:a(()=>[...e[16]||(e[16]=[p("或",-1)])]),_:1}),r(t,null,{default:a(()=>[r(b,{size:"large",class:"login-button",onClick:e[9]||(e[9]=s=>u.$router.push("/login"))},{default:a(()=>[...e[17]||(e[17]=[p(" 已有账号？登录 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])])}}}),ae=j(X,[["__scopeId","data-v-c1e82e24"]]);export{ae as default};
//# sourceMappingURL=Register-BXmMrO9W.js.map
