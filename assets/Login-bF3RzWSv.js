import{d as N,u as U,l as m,m as K,n as W,c as h,a as s,e as o,w as l,r,p as G,q as O,s as I,f as k,t as j,v as H,F as J,x as Q,y as X,z as Y,g as d,A as Z,B as ee,E as P,C as oe,o as x,D as le,G as te,_ as se}from"./index-DE8jxKp-.js";const ne={class:"login-page"},ae={class:"login-container"},re={class:"remembered-dropdown"},ie=["onClick"],de={class:"form-actions"},ue={class:"demo-tip"},me=N({__name:"Login",setup(ce){const C=Z(),V=oe(),R=U(),f=m(),_=m(!1),v=m(!1),w=m([]),c=m(!1);let i=null;const n=K({emailOrPhone:"",password:""});async function g(){w.value=await G()}function A(){i&&clearTimeout(i),i=setTimeout(()=>{c.value=!1,i=null},200)}function z(a){n.emailOrPhone=a.emailOrPhone,n.password=a.password}function D(a){z(a),c.value=!1,i&&(clearTimeout(i),i=null)}function L(a){te(a.emailOrPhone),g()}W(()=>g());const M={emailOrPhone:[{required:!0,message:"请输入邮箱或手机号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]};async function b(){f.value&&await f.value.validate(async a=>{if(a){_.value=!0;try{await R.login(n.emailOrPhone,n.password),v.value&&(await ee(n.emailOrPhone,n.password),await g()),P.success("登录成功");const e=V.query.redirect||"/",p=e.startsWith("/")&&!e.startsWith("//")?e:"/";C.replace(p)}catch(e){P.error(e.message||"登录失败")}finally{_.value=!1}}})}return(a,e)=>{const p=r("el-input"),y=r("el-button"),u=r("el-form-item"),S=r("el-checkbox"),T=r("el-link"),q=r("el-divider"),B=r("el-form"),$=r("el-alert"),E=r("el-card");return x(),h("div",ne,[s("div",ae,[o(E,{class:"login-card",shadow:"always"},{header:l(()=>[...e[5]||(e[5]=[s("div",{class:"card-header"},[s("h2",{class:"header-font"},"登录"),s("p",{class:"subtitle content-font"},"欢迎回来")],-1)])]),default:l(()=>[o(B,{ref_key:"formRef",ref:f,model:n,rules:M,"label-width":"0",onSubmit:O(b,["prevent"])},{default:l(()=>[o(u,{prop:"emailOrPhone"},{default:l(()=>[s("div",{class:"account-input-wrap",onMouseenter:e[1]||(e[1]=t=>c.value=!0),onMouseleave:A},[o(p,{modelValue:n.emailOrPhone,"onUpdate:modelValue":e[0]||(e[0]=t=>n.emailOrPhone=t),placeholder:"邮箱或手机号",size:"large","prefix-icon":k(j)},null,8,["modelValue","prefix-icon"]),I(s("div",re,[e[7]||(e[7]=s("div",{class:"remembered-dropdown-label"},"已保存的账号",-1)),(x(!0),h(J,null,Q(w.value,t=>(x(),h("div",{key:t.emailOrPhone,class:"remembered-dropdown-item",onClick:F=>D(t)},[s("span",null,le(t.emailOrPhone),1),o(y,{type:"danger",link:"",size:"small",class:"remembered-dropdown-delete",onClick:O(F=>L(t),["stop"])},{default:l(()=>[...e[6]||(e[6]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])],8,ie))),128))],512),[[H,c.value&&w.value.length]])],32)]),_:1}),o(u,{prop:"password"},{default:l(()=>[o(p,{modelValue:n.password,"onUpdate:modelValue":e[2]||(e[2]=t=>n.password=t),type:"password",placeholder:"密码",size:"large","prefix-icon":k(Y),"show-password":"",onKeyup:X(b,["enter"])},null,8,["modelValue","prefix-icon"])]),_:1}),o(u,null,{default:l(()=>[s("div",de,[o(S,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value=t)},{default:l(()=>[...e[8]||(e[8]=[d("记住我",-1)])]),_:1},8,["modelValue"]),o(T,{type:"primary",underline:!1},{default:l(()=>[...e[9]||(e[9]=[d("忘记密码？",-1)])]),_:1})])]),_:1}),o(u,null,{default:l(()=>[o(y,{type:"primary",size:"large",loading:_.value,class:"login-button",onClick:b},{default:l(()=>[...e[10]||(e[10]=[d(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1}),o(q,null,{default:l(()=>[...e[11]||(e[11]=[d("或",-1)])]),_:1}),o(u,null,{default:l(()=>[o(y,{size:"large",class:"register-button",onClick:e[4]||(e[4]=t=>k(C).push("/register"))},{default:l(()=>[...e[12]||(e[12]=[d(" 注册账号 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),s("div",ue,[o($,{title:"演示账号",type:"info",closable:!1,"show-icon":""},{default:l(()=>[...e[13]||(e[13]=[s("p",null,"管理员：admin@ink.com / 666666",-1),s("p",null,"学生：student@ink.com / 666666",-1)])]),_:1})])]),_:1})])])}}}),fe=se(me,[["__scopeId","data-v-4d957aff"]]);export{fe as default};
//# sourceMappingURL=Login-bF3RzWSv.js.map
