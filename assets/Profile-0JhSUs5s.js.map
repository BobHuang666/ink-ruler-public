{"version":3,"file":"Profile-0JhSUs5s.js","sources":["../../src/api/user.ts","../../src/api/feedback.ts","../../src/views/user/Profile.vue"],"sourcesContent":["import request from '@/utils/request'\nimport type { UserDetail, Membership } from '@/types/user'\n\n// 更新当前用户\nexport async function updateUser(data: {\n  nickname?: string\n  avatar?: string\n  password_old?: string\n  password_new?: string\n  email_code?: string\n}): Promise<UserDetail> {\n  await request.patch('/users/me', data)\n  const res = await request.get<Record<string, unknown>>('/users/me')\n  const d = res.data\n  const membership = d.membership as\n    | { plan: string; expired_at: string; status: string; quota_remaining?: number | null }\n    | undefined\n  return {\n    id: d.id as number,\n    email: d.email as string,\n    phone: d.phone as string | undefined,\n    nickname: (d.nickname as string) || '',\n    avatar: d.avatar as string | undefined,\n    role: d.role as UserDetail['role'],\n    status: d.status as UserDetail['status'],\n    created_at: (d.created_at as string) ?? '',\n    updated_at: (d.updated_at as string) ?? '',\n    ...(membership && {\n      membership: {\n        id: 0,\n        user_id: d.id as number,\n        plan: membership.plan as 'student' | 'teacher',\n        started_at: '',\n        expired_at: membership.expired_at,\n        status: membership.status as 'active' | 'expired' | 'cancelled',\n        quota_remaining: membership.quota_remaining ?? undefined,\n        created_at: '',\n        updated_at: '',\n      },\n    }),\n  }\n}\n\n// 获取当前会员信息\nexport async function getMembership(): Promise<Membership | null> {\n  const res = await request.get<Membership | null>('/memberships/me')\n  return res.data\n}\n\n// 兑换码兑换会员\nexport async function redeemMembership(code: string): Promise<Membership> {\n  const res = await request.post<Membership>('/memberships/redeem', { code })\n  return res.data\n}\n\n// 向当前用户邮箱发送验证码（用于注销等）\nexport async function sendEmailCodeForMe(): Promise<void> {\n  await request.post('/users/me/send-email-code')\n}\n\n// 注销账号（需密码+邮箱验证码）\nexport async function cancelAccount(password: string, emailCode: string): Promise<void> {\n  await request.post('/users/me/cancel', { password, email_code: emailCode })\n}\n","import request from '@/utils/request'\n\n// 提交反馈（可未登录）\nexport async function createFeedback(data: {\n  content: string\n  contact?: string\n}): Promise<{ id: number }> {\n  const res = await request.post<{ id: number }>('/feedbacks', data)\n  return res.data\n}\n","<template>\n  <div class=\"profile-page\">\n    <div class=\"container\">\n      <el-row :gutter=\"20\">\n        <el-col :xs=\"24\" :sm=\"24\" :md=\"6\" :lg=\"6\">\n          <el-card shadow=\"never\" class=\"profile-card\">\n            <div class=\"avatar-section\">\n              <el-avatar :size=\"100\" :src=\"form.avatar\">\n                {{ form.nickname?.[0] }}\n              </el-avatar>\n              <h3 class=\"header-font\">{{ form.nickname }}</h3>\n              <p class=\"email\">{{ form.email }}</p>\n              <el-tag v-if=\"authStore.isMember\" type=\"success\">会员</el-tag>\n              <el-tag v-else type=\"info\">普通用户</el-tag>\n            </div>\n          </el-card>\n        </el-col>\n        <el-col :xs=\"24\" :sm=\"24\" :md=\"18\" :lg=\"18\">\n          <el-tabs v-model=\"activeTab\" class=\"profile-tabs\">\n            <el-tab-pane label=\"个人信息\" name=\"info\">\n              <el-card shadow=\"never\">\n                <el-form\n                  :model=\"form\"\n                  :rules=\"rules\"\n                  ref=\"formRef\"\n                  class=\"profile-form\"\n                  label-width=\"100px\"\n                >\n                  <el-form-item label=\"昵称\" prop=\"nickname\">\n                    <el-input v-model=\"form.nickname\" />\n                  </el-form-item>\n                  <el-form-item label=\"邮箱\">\n                    <el-input v-model=\"form.email\" disabled />\n                  </el-form-item>\n                  <el-form-item label=\"手机号\">\n                    <el-input v-model=\"form.phone\" disabled />\n                  </el-form-item>\n                  <el-form-item>\n                    <el-button type=\"primary\" @click=\"handleUpdateInfo\">保存</el-button>\n                  </el-form-item>\n                </el-form>\n              </el-card>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"修改密码\" name=\"password\">\n              <el-card shadow=\"never\">\n                <p v-if=\"passwordMaskedEmail\" class=\"password-email-hint\">\n                  将向您的邮箱 {{ passwordMaskedEmail }} 发送验证码\n                </p>\n                <el-form\n                  :model=\"passwordForm\"\n                  :rules=\"passwordRules\"\n                  ref=\"passwordFormRef\"\n                  class=\"profile-form\"\n                  label-width=\"100px\"\n                >\n                  <el-form-item label=\"验证码\" required>\n                    <div class=\"password-code-row\">\n                      <el-input\n                        v-model=\"passwordForm.email_code\"\n                        placeholder=\"4位验证码\"\n                        maxlength=\"4\"\n                        class=\"password-code-input\"\n                      />\n                      <el-button\n                        type=\"primary\"\n                        :disabled=\"passwordCountdown > 0\"\n                        :loading=\"passwordSendingCode\"\n                        @click=\"handleSendPasswordCode\"\n                      >\n                        {{ passwordCountdown > 0 ? `${passwordCountdown}s 后重试` : '获取验证码' }}\n                      </el-button>\n                    </div>\n                  </el-form-item>\n                  <el-form-item label=\"原密码\" prop=\"oldPassword\">\n                    <el-input v-model=\"passwordForm.oldPassword\" type=\"password\" show-password />\n                  </el-form-item>\n                  <el-form-item label=\"新密码\" prop=\"newPassword\">\n                    <el-input v-model=\"passwordForm.newPassword\" type=\"password\" show-password />\n                  </el-form-item>\n                  <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\n                    <el-input\n                      v-model=\"passwordForm.confirmPassword\"\n                      type=\"password\"\n                      show-password\n                    />\n                  </el-form-item>\n                  <el-form-item>\n                    <el-button type=\"primary\" @click=\"handleUpdatePassword\">修改密码</el-button>\n                  </el-form-item>\n                </el-form>\n              </el-card>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"会员信息\" name=\"membership\">\n              <el-card shadow=\"never\">\n                <div class=\"membership-intro\">\n                  <p>\n                    会员需通过站外购买获得，购买后将获得兑换码。如有需要请联系客服或查看站内公告获取购买方式与兑换码。\n                  </p>\n                </div>\n                <!-- 时间型会员：显示计划、状态、开始/到期，次数卡剩余放底部 -->\n                <div v-if=\"hasTimeMember && membership\" class=\"membership-info\">\n                  <el-descriptions :column=\"1\" border>\n                    <el-descriptions-item label=\"会员计划\">{{\n                      membership.plan\n                    }}</el-descriptions-item>\n                    <el-descriptions-item label=\"状态\">\n                      <el-tag :type=\"membership.status === 'active' ? 'success' : 'info'\">\n                        {{ membership.status === 'active' ? '有效' : '已过期' }}\n                      </el-tag>\n                    </el-descriptions-item>\n                    <el-descriptions-item label=\"开始时间\">\n                      {{ new Date(membership.started_at).toLocaleDateString() }}\n                    </el-descriptions-item>\n                    <el-descriptions-item label=\"到期时间\">\n                      {{ new Date(membership.expired_at).toLocaleDateString() }}\n                    </el-descriptions-item>\n                    <el-descriptions-item\n                      v-if=\"(membership.quota_remaining ?? 0) > 0\"\n                      label=\"次数卡剩余\"\n                    >\n                      {{ membership.quota_remaining }}\n                    </el-descriptions-item>\n                  </el-descriptions>\n                </div>\n                <!-- 仅次数无会员：只显示次数卡剩余 -->\n                <div\n                  v-else-if=\"membership && (membership.quota_remaining ?? 0) > 0\"\n                  class=\"membership-info\"\n                >\n                  <el-descriptions :column=\"1\" border>\n                    <el-descriptions-item label=\"次数卡剩余\">\n                      {{ membership.quota_remaining }}\n                    </el-descriptions-item>\n                  </el-descriptions>\n                </div>\n                <el-empty v-else description=\"您还不是会员\" />\n                <div class=\"membership-redeem\">\n                  <div class=\"redeem-label\">兑换码</div>\n                  <div class=\"redeem-row\">\n                    <el-input\n                      v-model=\"redeemCode\"\n                      placeholder=\"请输入兑换码\"\n                      clearable\n                      maxlength=\"64\"\n                      class=\"redeem-input\"\n                    />\n                    <el-button\n                      type=\"primary\"\n                      :loading=\"redeemLoading\"\n                      :disabled=\"!redeemCode.trim()\"\n                      @click=\"handleRedeemCode\"\n                    >\n                      兑换\n                    </el-button>\n                  </div>\n                </div>\n              </el-card>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"收藏夹\" name=\"favorites\">\n              <el-card shadow=\"never\">\n                <div v-if=\"favorites.length || favoritesLoading\" class=\"table-scroll-wrap\">\n                  <el-table\n                    v-loading=\"favoritesLoading\"\n                    :data=\"favorites\"\n                    class=\"profile-table\"\n                    style=\"width: 100%\"\n                  >\n                    <el-table-column prop=\"title\" label=\"标题\" min-width=\"120\">\n                      <template #default=\"{ row }\">\n                        <router-link :to=\"`/essay/${row.essay_id}`\" class=\"table-link\">\n                          {{ row.title || '无标题' }}\n                        </router-link>\n                      </template>\n                    </el-table-column>\n                    <el-table-column label=\"收藏时间\" min-width=\"150\">\n                      <template #default=\"{ row }\">\n                        {{ new Date(row.essay_created_at).toLocaleString() }}\n                      </template>\n                    </el-table-column>\n                    <el-table-column label=\"操作\" min-width=\"100\" align=\"right\">\n                      <template #default=\"{ row }\">\n                        <el-button\n                          type=\"danger\"\n                          text\n                          :loading=\"unfavoriteId === row.essay_id\"\n                          @click=\"handleUnfavorite(row)\"\n                        >\n                          取消收藏\n                        </el-button>\n                      </template>\n                    </el-table-column>\n                  </el-table>\n                </div>\n                <el-empty v-else description=\"暂无收藏\" />\n              </el-card>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"素材收藏\" name=\"classicFavorites\">\n              <el-card shadow=\"never\">\n                <div\n                  v-if=\"classicFavorites.length || classicFavoritesLoading\"\n                  class=\"table-scroll-wrap\"\n                >\n                  <el-table\n                    v-loading=\"classicFavoritesLoading\"\n                    :data=\"classicFavorites\"\n                    class=\"profile-table\"\n                    style=\"width: 100%\"\n                  >\n                    <el-table-column label=\"内容\" min-width=\"180\">\n                      <template #default=\"{ row }\">\n                        <router-link :to=\"`/classic/item/${row.id}`\" class=\"table-link\">\n                          {{ row.original_text?.slice(0, 50)\n                          }}{{ (row.original_text?.length ?? 0) > 50 ? '…' : '' }}\n                        </router-link>\n                      </template>\n                    </el-table-column>\n                    <el-table-column label=\"作者/朝代\" min-width=\"100\">\n                      <template #default=\"{ row }\"> {{ row.author }} {{ row.dynasty }} </template>\n                    </el-table-column>\n                    <el-table-column label=\"操作\" min-width=\"100\" align=\"right\">\n                      <template #default=\"{ row }\">\n                        <el-button\n                          type=\"danger\"\n                          text\n                          :loading=\"unfavoriteClassicId === row.id\"\n                          @click=\"handleUnfavoriteClassic(row)\"\n                        >\n                          取消收藏\n                        </el-button>\n                      </template>\n                    </el-table-column>\n                  </el-table>\n                </div>\n                <el-empty v-else description=\"暂无素材收藏\">\n                  <el-button type=\"primary\" @click=\"$router.push('/classic')\">去素材中心</el-button>\n                </el-empty>\n              </el-card>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"反馈建议\" name=\"feedback\">\n              <el-card shadow=\"never\">\n                <el-form :model=\"feedbackForm\" class=\"profile-form\" label-width=\"100px\">\n                  <el-form-item label=\"反馈内容\">\n                    <el-input\n                      v-model=\"feedbackForm.content\"\n                      type=\"textarea\"\n                      :rows=\"6\"\n                      placeholder=\"请输入您的反馈或建议...\"\n                    />\n                  </el-form-item>\n                  <el-form-item label=\"联系方式\">\n                    <el-input v-model=\"feedbackForm.contact\" placeholder=\"邮箱或手机号（可选）\" />\n                  </el-form-item>\n                  <el-form-item>\n                    <el-button type=\"primary\" @click=\"handleSubmitFeedback\">提交反馈</el-button>\n                  </el-form-item>\n                </el-form>\n              </el-card>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"账号安全\" name=\"security\">\n              <el-card shadow=\"never\">\n                <div class=\"security-section\">\n                  <h4>注销账号</h4>\n                  <p class=\"security-desc\">注销后账号及关联数据将被删除且无法恢复，请谨慎操作。</p>\n                  <el-button type=\"danger\" plain @click=\"openCancelDialog\">申请注销账号</el-button>\n                </div>\n              </el-card>\n              <el-dialog\n                v-model=\"cancelDialogVisible\"\n                title=\"注销账号\"\n                width=\"400px\"\n                class=\"cancel-account-dialog\"\n                :close-on-click-modal=\"false\"\n                @closed=\"onCancelDialogClosed\"\n              >\n                <el-alert\n                  class=\"tip-alert cancel-dialog-tip\"\n                  title=\"提示\"\n                  type=\"warning\"\n                  :closable=\"false\"\n                  show-icon\n                >\n                  注销后账号及关联数据将被删除且无法恢复，请谨慎操作。请先获取验证码，再输入当前密码与验证码并点击「确认注销」。\n                </el-alert>\n                <p v-if=\"cancelMaskedEmail\" class=\"cancel-email-hint\">\n                  将向您的邮箱 {{ cancelMaskedEmail }} 发送验证码\n                </p>\n                <el-form\n                  :model=\"cancelForm\"\n                  label-width=\"80px\"\n                  @submit.prevent=\"handleCancelAccount\"\n                >\n                  <el-form-item label=\"验证码\" required>\n                    <div class=\"cancel-code-row\">\n                      <el-input\n                        v-model=\"cancelForm.email_code\"\n                        placeholder=\"4位验证码\"\n                        maxlength=\"4\"\n                        show-word-limit\n                        class=\"cancel-code-input\"\n                      />\n                      <el-button\n                        type=\"primary\"\n                        :disabled=\"cancelCountdown > 0\"\n                        :loading=\"cancelSendingCode\"\n                        @click=\"handleSendCancelCode\"\n                      >\n                        {{ cancelCountdown > 0 ? `${cancelCountdown}s 后重试` : '获取验证码' }}\n                      </el-button>\n                    </div>\n                  </el-form-item>\n                  <el-form-item label=\"当前密码\" required>\n                    <el-input\n                      v-model=\"cancelForm.password\"\n                      type=\"password\"\n                      show-password\n                      placeholder=\"请输入当前密码以确认\"\n                      @keyup.enter=\"handleCancelAccount\"\n                    />\n                  </el-form-item>\n                </el-form>\n                <template #footer>\n                  <el-button @click=\"cancelDialogVisible = false\">取消</el-button>\n                  <el-button type=\"danger\" :loading=\"cancelLoading\" @click=\"handleCancelAccount\">\n                    确认注销\n                  </el-button>\n                </template>\n              </el-dialog>\n            </el-tab-pane>\n          </el-tabs>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, onMounted, watch, onUnmounted, computed } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useAuthStore } from '@/stores/auth'\nimport { maskEmail } from '@/utils/format'\nimport * as userApi from '@/api/user'\nimport * as feedbackApi from '@/api/feedback'\nimport * as essayApi from '@/api/essay'\nimport * as classicApi from '@/api/classic'\nimport { ElMessage, type FormInstance, type FormRules } from 'element-plus'\nimport type { Membership } from '@/types/user'\nimport type { FavoriteItem } from '@/types/essay'\nimport type { ClassicItem } from '@/types/classic'\n\nconst router = useRouter()\nconst authStore = useAuthStore()\n\nconst activeTab = ref('info')\nconst formRef = ref<FormInstance>()\nconst passwordFormRef = ref<FormInstance>()\nconst membership = ref<Membership | null>(null)\nconst redeemCode = ref('')\nconst redeemLoading = ref(false)\n\nconst form = reactive({\n  nickname: '',\n  email: '',\n  phone: '',\n  avatar: '',\n})\n\nconst passwordForm = reactive({\n  email_code: '',\n  oldPassword: '',\n  newPassword: '',\n  confirmPassword: '',\n})\n\nconst passwordMaskedEmail = computed(() =>\n  authStore.user?.email ? maskEmail(authStore.user.email) : ''\n)\nconst cancelMaskedEmail = computed(() =>\n  authStore.user?.email ? maskEmail(authStore.user.email) : ''\n)\n// 时间型会员：有开始/到期时间（次数型不算会员，不显示状态与日期）\nconst hasTimeMember = computed(\n  () =>\n    !!(\n      membership.value?.started_at &&\n      membership.value?.expired_at &&\n      !String(membership.value.expired_at).startsWith('0001')\n    )\n)\n\nconst passwordSendingCode = ref(false)\nconst passwordCountdown = ref(0)\nlet passwordCountdownTimer: ReturnType<typeof setInterval> | null = null\n\nconst feedbackForm = reactive({\n  content: '',\n  contact: '',\n})\n\nconst cancelDialogVisible = ref(false)\nconst cancelLoading = ref(false)\nconst cancelSendingCode = ref(false)\nconst cancelCountdown = ref(0)\nlet cancelCountdownTimer: ReturnType<typeof setInterval> | null = null\nconst cancelForm = reactive({ password: '', email_code: '' })\n\nconst favorites = ref<FavoriteItem[]>([])\nconst favoritesLoading = ref(false)\nconst unfavoriteId = ref<number | null>(null)\nconst classicFavorites = ref<ClassicItem[]>([])\nconst classicFavoritesLoading = ref(false)\nconst unfavoriteClassicId = ref<number | null>(null)\n\nconst rules: FormRules = {\n  nickname: [\n    { required: true, message: '请输入昵称', trigger: 'blur' },\n    { min: 2, max: 20, message: '昵称长度在2到20个字符', trigger: 'blur' },\n  ],\n}\n\nconst validateConfirmPassword = (\n  _rule: unknown,\n  value: string,\n  callback: (error?: Error) => void\n) => {\n  if (value !== passwordForm.newPassword) {\n    callback(new Error('两次输入的密码不一致'))\n  } else {\n    callback()\n  }\n}\n\nconst passwordRules: FormRules = {\n  oldPassword: [{ required: true, message: '请输入原密码', trigger: 'blur' }],\n  newPassword: [\n    { required: true, message: '请输入新密码', trigger: 'blur' },\n    { min: 6, message: '密码长度不能少于6位', trigger: 'blur' },\n  ],\n  confirmPassword: [\n    { required: true, message: '请确认密码', trigger: 'blur' },\n    { validator: validateConfirmPassword, trigger: 'blur' },\n  ],\n}\n\nasync function handleSendPasswordCode() {\n  if (passwordCountdown.value > 0) return\n  passwordSendingCode.value = true\n  try {\n    await userApi.sendEmailCodeForMe()\n    ElMessage.success(`验证码已发送至 ${passwordMaskedEmail.value}，请查收`)\n    passwordCountdown.value = 60\n    passwordCountdownTimer = setInterval(() => {\n      passwordCountdown.value--\n      if (passwordCountdown.value <= 0 && passwordCountdownTimer) {\n        clearInterval(passwordCountdownTimer)\n        passwordCountdownTimer = null\n      }\n    }, 1000)\n  } catch (error: unknown) {\n    ElMessage.error((error as Error).message || '发送失败')\n  } finally {\n    passwordSendingCode.value = false\n  }\n}\n\nonMounted(async () => {\n  if (authStore.user) {\n    form.nickname = authStore.user.nickname\n    form.email = authStore.user.email || ''\n    form.phone = authStore.user.phone || ''\n    form.avatar = authStore.user.avatar || ''\n  }\n  await fetchMembership()\n})\n\nwatch(activeTab, (tab) => {\n  if (tab === 'favorites') fetchFavorites()\n  if (tab === 'classicFavorites') fetchClassicFavorites()\n})\n\nasync function fetchFavorites() {\n  favoritesLoading.value = true\n  try {\n    favorites.value = await essayApi.getFavorites()\n  } catch {\n    favorites.value = []\n  } finally {\n    favoritesLoading.value = false\n  }\n}\n\nasync function handleUnfavorite(item: FavoriteItem) {\n  unfavoriteId.value = item.essay_id\n  try {\n    await essayApi.unfavoriteEssay(item.essay_id)\n    favorites.value = favorites.value.filter((f) => f.essay_id !== item.essay_id)\n    ElMessage.success('已取消收藏')\n  } catch (error: unknown) {\n    ElMessage.error((error as Error).message || '取消收藏失败')\n  } finally {\n    unfavoriteId.value = null\n  }\n}\n\nasync function fetchClassicFavorites() {\n  classicFavoritesLoading.value = true\n  try {\n    classicFavorites.value = await classicApi.getClassicFavorites()\n  } catch {\n    classicFavorites.value = []\n  } finally {\n    classicFavoritesLoading.value = false\n  }\n}\n\nasync function handleUnfavoriteClassic(c: ClassicItem) {\n  unfavoriteClassicId.value = c.id\n  try {\n    await classicApi.unfavorite(c.id)\n    classicFavorites.value = classicFavorites.value.filter((x) => x.id !== c.id)\n    ElMessage.success('已取消收藏')\n  } catch (error: unknown) {\n    ElMessage.error((error as Error).message || '取消收藏失败')\n  } finally {\n    unfavoriteClassicId.value = null\n  }\n}\n\nasync function fetchMembership() {\n  try {\n    membership.value = await userApi.getMembership()\n  } catch {\n    // 忽略错误\n  }\n}\n\nasync function handleUpdateInfo() {\n  if (!formRef.value) return\n  await formRef.value.validate(async (valid) => {\n    if (valid) {\n      try {\n        await userApi.updateUser({ nickname: form.nickname })\n        await authStore.fetchUser()\n        ElMessage.success('更新成功')\n      } catch (error: unknown) {\n        ElMessage.error((error as Error).message || '更新失败')\n      }\n    }\n  })\n}\n\nasync function handleUpdatePassword() {\n  if (!passwordFormRef.value) return\n  if (!passwordForm.email_code.trim() || passwordForm.email_code.length !== 4) {\n    ElMessage.warning('请输入4位验证码')\n    return\n  }\n  await passwordFormRef.value.validate(async (valid) => {\n    if (valid) {\n      try {\n        await userApi.updateUser({\n          password_old: passwordForm.oldPassword,\n          password_new: passwordForm.newPassword,\n          email_code: passwordForm.email_code,\n        })\n        ElMessage.success('密码修改成功')\n        passwordForm.email_code = ''\n        passwordForm.oldPassword = ''\n        passwordForm.newPassword = ''\n        passwordForm.confirmPassword = ''\n      } catch (error: unknown) {\n        ElMessage.error((error as Error).message || '密码修改失败')\n      }\n    }\n  })\n}\n\nasync function handleRedeemCode() {\n  const code = redeemCode.value.trim()\n  if (!code) return\n  redeemLoading.value = true\n  try {\n    await userApi.redeemMembership(code)\n    await authStore.fetchUser()\n    // 重新拉取会员信息，使时间型会员与次数卡合并展示，无需刷新页面\n    membership.value = await userApi.getMembership()\n    redeemCode.value = ''\n    ElMessage.success('兑换成功')\n  } catch (error: unknown) {\n    ElMessage.error((error as Error).message || '兑换失败')\n  } finally {\n    redeemLoading.value = false\n  }\n}\n\nasync function handleSubmitFeedback() {\n  if (!feedbackForm.content.trim()) {\n    ElMessage.warning('请输入反馈内容')\n    return\n  }\n  try {\n    await feedbackApi.createFeedback({\n      content: feedbackForm.content.trim(),\n      contact: feedbackForm.contact.trim() || undefined,\n    })\n    ElMessage.success('反馈提交成功，感谢您的建议！')\n    feedbackForm.content = ''\n    feedbackForm.contact = ''\n  } catch (error: unknown) {\n    ElMessage.error((error as Error).message || '提交失败')\n  }\n}\n\nfunction onCancelDialogClosed() {\n  cancelForm.password = ''\n  cancelForm.email_code = ''\n}\n\nfunction openCancelDialog() {\n  cancelForm.password = ''\n  cancelForm.email_code = ''\n  cancelDialogVisible.value = true\n}\n\nasync function handleSendCancelCode() {\n  if (cancelCountdown.value > 0) return\n  cancelSendingCode.value = true\n  try {\n    await userApi.sendEmailCodeForMe()\n    ElMessage.success(`验证码已发送至 ${cancelMaskedEmail.value}，请查收`)\n    cancelCountdown.value = 60\n    cancelCountdownTimer = setInterval(() => {\n      cancelCountdown.value--\n      if (cancelCountdown.value <= 0 && cancelCountdownTimer) {\n        clearInterval(cancelCountdownTimer)\n        cancelCountdownTimer = null\n      }\n    }, 1000)\n  } catch (error: unknown) {\n    ElMessage.error((error as Error).message || '发送失败')\n  } finally {\n    cancelSendingCode.value = false\n  }\n}\n\nonUnmounted(() => {\n  if (cancelCountdownTimer) clearInterval(cancelCountdownTimer)\n  if (passwordCountdownTimer) clearInterval(passwordCountdownTimer)\n})\n\nasync function handleCancelAccount() {\n  if (!cancelForm.password.trim()) {\n    ElMessage.warning('请输入当前密码')\n    return\n  }\n  if (!cancelForm.email_code.trim() || cancelForm.email_code.length !== 4) {\n    ElMessage.warning('请输入4位验证码')\n    return\n  }\n  cancelLoading.value = true\n  try {\n    await userApi.cancelAccount(cancelForm.password, cancelForm.email_code)\n    authStore.clearLocal()\n    cancelDialogVisible.value = false\n    ElMessage.success('账号已注销')\n    router.replace('/')\n  } catch (error: unknown) {\n    ElMessage.error((error as Error).message || '注销失败')\n  } finally {\n    cancelLoading.value = false\n  }\n}\n</script>\n\n<style scoped>\n.profile-page {\n  min-height: calc(100vh - var(--header-height) - 80px);\n  padding: var(--spacing-lg) 0;\n  background: transparent;\n}\n\n.container {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 0 var(--spacing-md);\n}\n\n/* 标签栏仅支持横向滑动，无箭头、无滚动条 */\n.profile-tabs :deep(.el-tabs__nav-prev),\n.profile-tabs :deep(.el-tabs__nav-next) {\n  display: none;\n}\n.profile-tabs :deep(.el-tabs__nav-scroll) {\n  overflow-x: auto;\n  overflow-y: hidden;\n  -webkit-overflow-scrolling: touch;\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n}\n.profile-tabs :deep(.el-tabs__nav-scroll)::-webkit-scrollbar {\n  display: none;\n}\n.profile-tabs :deep(.el-tabs__nav) {\n  flex-wrap: nowrap;\n  min-width: min-content;\n}\n.profile-tabs :deep(.el-tabs__item) {\n  white-space: nowrap;\n}\n.profile-tabs :deep(.el-tabs__header) {\n  margin-bottom: var(--spacing-md);\n}\n\n.profile-card {\n  text-align: center;\n}\n\n.avatar-section {\n  padding: var(--spacing-lg) 0;\n}\n\n.avatar-section h3 {\n  margin: var(--spacing-md) 0 var(--spacing-xs);\n  font-size: var(--font-size-lg);\n  font-weight: 600;\n}\n\n.email {\n  color: var(--color-text-secondary);\n  font-size: var(--font-size-sm);\n  margin-bottom: var(--spacing-md);\n}\n\n.membership-intro {\n  margin-bottom: var(--spacing-lg);\n  padding: var(--spacing-sm) 0;\n  font-size: var(--font-size-sm);\n  color: var(--color-text-secondary);\n}\n\n.membership-info {\n  padding: var(--spacing-md);\n}\n\n.membership-redeem {\n  margin-top: var(--spacing-lg);\n  padding-top: var(--spacing-lg);\n  border-top: 1px solid var(--border-color-light, #ebeef5);\n}\n\n.redeem-label {\n  font-size: var(--font-size-sm);\n  margin-bottom: var(--spacing-sm);\n  color: var(--color-text-secondary);\n}\n\n.redeem-row {\n  display: flex;\n  gap: var(--spacing-sm);\n  align-items: center;\n}\n\n.redeem-input {\n  flex: 1;\n  max-width: 280px;\n}\n\n.security-section h4 {\n  margin-bottom: var(--spacing-sm);\n  font-size: var(--font-size-base);\n}\n\n.security-desc {\n  color: var(--color-text-secondary);\n  font-size: var(--font-size-sm);\n  margin-bottom: var(--spacing-md);\n}\n\n.cancel-email-hint {\n  margin: 0 0 var(--spacing-sm);\n  font-size: var(--font-size-sm);\n  color: var(--color-text-secondary);\n}\n\n.cancel-dialog-tip {\n  margin-bottom: var(--spacing-md);\n}\n\n.cancel-code-row {\n  display: flex;\n  gap: var(--spacing-sm);\n  width: 100%;\n}\n.cancel-code-input {\n  flex: 1;\n  min-width: 0;\n}\n\n.password-email-hint {\n  margin: 0 0 var(--spacing-md);\n  font-size: var(--font-size-sm);\n  color: var(--color-text-secondary);\n}\n\n.password-code-row {\n  display: flex;\n  gap: var(--spacing-sm);\n  width: 100%;\n}\n.password-code-input {\n  flex: 1;\n  min-width: 0;\n}\n\n.favorites-list {\n  min-height: 120px;\n}\n\n.favorite-item {\n  display: flex;\n  align-items: center;\n  gap: var(--spacing-md);\n  padding: var(--spacing-sm) 0;\n  border-bottom: 1px solid var(--border-color-light, #ebeef5);\n}\n\n.favorite-item:last-child {\n  border-bottom: none;\n}\n\n.favorite-title {\n  flex: 1;\n  min-width: 0;\n  color: var(--color-primary);\n  text-decoration: none;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.favorite-title:hover {\n  text-decoration: underline;\n}\n\n.favorite-time,\n.favorite-meta {\n  flex-shrink: 0;\n  font-size: var(--font-size-sm);\n  color: var(--color-text-secondary);\n}\n\n.favorite-item .el-button {\n  flex-shrink: 0;\n}\n\n/* 小屏时表单 label 改为 80px */\n@media (max-width: 768px) {\n  .profile-page :deep(.profile-form .el-form-item__label) {\n    width: 80px !important;\n  }\n}\n\n/* 收藏表格可左右滑动，与历史记录一致 */\n.table-scroll-wrap {\n  overflow-x: auto;\n  min-height: 120px;\n}\n.profile-table {\n  min-width: 400px;\n}\n.table-link {\n  color: var(--color-primary);\n  text-decoration: none;\n}\n.table-link:hover {\n  text-decoration: underline;\n}\n</style>\n\n<!-- 注销弹窗挂到 body，需单独样式避免小屏溢出 -->\n<style>\n@media (max-width: 480px) {\n  .cancel-account-dialog.el-dialog {\n    --el-dialog-width: calc(100vw - 32px) !important;\n    width: calc(100vw - 32px) !important;\n    max-width: calc(100vw - 32px);\n  }\n}\n</style>\n"],"names":["updateUser","data","request","d","membership","getMembership","redeemMembership","code","sendEmailCodeForMe","cancelAccount","password","emailCode","createFeedback","router","useRouter","authStore","useAuthStore","activeTab","ref","formRef","passwordFormRef","redeemCode","redeemLoading","form","reactive","passwordForm","passwordMaskedEmail","computed","maskEmail","cancelMaskedEmail","hasTimeMember","passwordSendingCode","passwordCountdown","passwordCountdownTimer","feedbackForm","cancelDialogVisible","cancelLoading","cancelSendingCode","cancelCountdown","cancelCountdownTimer","cancelForm","favorites","favoritesLoading","unfavoriteId","classicFavorites","classicFavoritesLoading","unfavoriteClassicId","rules","passwordRules","_rule","value","callback","handleSendPasswordCode","userApi.sendEmailCodeForMe","ElMessage","error","onMounted","fetchMembership","watch","tab","fetchFavorites","fetchClassicFavorites","essayApi.getFavorites","handleUnfavorite","item","essayApi.unfavoriteEssay","f","classicApi.getClassicFavorites","handleUnfavoriteClassic","c","classicApi.unfavorite","x","userApi.getMembership","handleUpdateInfo","valid","userApi.updateUser","handleUpdatePassword","handleRedeemCode","userApi.redeemMembership","handleSubmitFeedback","feedbackApi.createFeedback","onCancelDialogClosed","openCancelDialog","handleSendCancelCode","onUnmounted","handleCancelAccount","userApi.cancelAccount","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_row","_component_el_col","_component_el_card","_hoisted_3","_component_el_avatar","_createTextVNode","_toDisplayString","_hoisted_4","_hoisted_5","_unref","_createBlock","_component_el_tag","_cache","_component_el_tabs","$event","_component_el_tab_pane","_component_el_form","_component_el_form_item","_component_el_input","_component_el_button","_hoisted_6","_hoisted_7","_hoisted_8","_component_el_descriptions","_component_el_descriptions_item","_hoisted_9","_component_el_empty","_hoisted_10","_hoisted_11","_hoisted_12","_component_el_table","_component_el_table_column","_withCtx","row","_component_router_link","_hoisted_13","$router","_hoisted_14","_component_el_dialog","_component_el_alert","_hoisted_15","_hoisted_16"],"mappings":"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"}