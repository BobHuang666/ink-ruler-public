{"version":3,"file":"Search-CI2svKm2.js","sources":["../../src/views/classic/Search.vue"],"sourcesContent":["<template>\n  <div class=\"classic-search-page\">\n    <div class=\"search-inner\">\n      <div class=\"search-bar\">\n        <el-input\n          v-model=\"inputQ\"\n          placeholder=\"输入关键词搜索\"\n          size=\"large\"\n          clearable\n          class=\"input\"\n          @keyup.enter=\"doSearch\"\n        >\n          <template #append>\n            <el-button type=\"primary\" @click=\"doSearch\">搜索</el-button>\n          </template>\n        </el-input>\n      </div>\n      <div v-if=\"searched\" class=\"result-header\">\n        <span>“{{ displayQuery }}” 共 {{ total }} 条</span>\n      </div>\n      <div v-if=\"loading\" class=\"loading-wrap\">\n        <el-icon class=\"is-loading\" :size=\"32\"><Loading /></el-icon>\n      </div>\n      <div v-else-if=\"searched && results.length === 0\" class=\"empty\">暂无结果</div>\n      <div v-else class=\"list-wrap\">\n        <router-link\n          v-for=\"item in currentPageItems\"\n          :key=\"item.id\"\n          :to=\"`/classic/item/${item.id}`\"\n          class=\"item-card\"\n        >\n          <p class=\"original content-font\">{{ item.original_text }}</p>\n          <p v-if=\"showTranslation && item.translation\" class=\"translation\">\n            {{ item.translation }}\n          </p>\n          <div class=\"meta\">\n            <span v-if=\"showAuthor && item.author\">{{ item.author }}</span>\n            <span v-if=\"showDynasty && item.dynasty\">{{ item.dynasty }}</span>\n            <span v-if=\"item.source\">{{ item.source }}</span>\n          </div>\n        </router-link>\n      </div>\n      <div v-if=\"totalPages > 1\" class=\"pagination-wrap\">\n        <el-pagination\n          v-model:current-page=\"currentPage\"\n          :page-size=\"pageSize\"\n          :total=\"total\"\n          layout=\"prev, pager, next\"\n          @current-change=\"() => {}\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch, onMounted } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { Loading } from '@element-plus/icons-vue'\nimport { search } from '@/api/classic'\nimport type { ClassicItem } from '@/types/classic'\n\nconst route = useRoute()\nconst inputQ = ref('')\nconst displayQuery = ref('')\nconst results = ref<ClassicItem[]>([])\nconst loading = ref(false)\nconst searched = ref(false)\nconst showTranslation = ref(true)\nconst showAuthor = ref(true)\nconst showDynasty = ref(true)\nconst pageSize = 20\nconst currentPage = ref(1)\n\nconst routeQuery = computed(() => (route.query.q as string) ?? '')\n\nconst total = computed(() => results.value.length)\nconst totalPages = computed(() => Math.ceil(total.value / pageSize) || 1)\nconst currentPageItems = computed(() => {\n  const start = (currentPage.value - 1) * pageSize\n  return results.value.slice(start, start + pageSize)\n})\n\nasync function doSearch() {\n  const q = inputQ.value?.trim()\n  if (!q) return\n  displayQuery.value = q\n  loading.value = true\n  searched.value = true\n  try {\n    const list = await search(q, 'keyword')\n    results.value = list ?? []\n    currentPage.value = 1\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction loadFromRoute() {\n  const q = routeQuery.value\n  if (q) {\n    inputQ.value = q\n    doSearch()\n  }\n}\n\nwatch(() => route.query.q, loadFromRoute)\nonMounted(loadFromRoute)\n</script>\n\n<style scoped>\n.classic-search-page {\n  position: relative;\n  min-height: calc(100vh - var(--header-height) - 80px);\n}\n.search-inner {\n  max-width: 56rem;\n  margin: 0 auto;\n  padding: 32px 24px 40px;\n  background: rgba(255, 255, 255, 0.75);\n  border-radius: 16px;\n  box-shadow: var(--card-shadow);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n}\n.search-bar {\n  width: 100%;\n  margin: 0 auto 24px;\n  padding: 6px;\n  border-radius: 16px;\n  background: linear-gradient(\n    135deg,\n    rgba(251, 135, 158, 0.25) 0%,\n    rgba(255, 255, 255, 0.4) 50%,\n    rgba(144, 202, 249, 0.25) 100%\n  );\n  backdrop-filter: blur(12px);\n  -webkit-backdrop-filter: blur(12px);\n  box-shadow: 0 4px 24px rgba(120, 113, 108, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.25);\n}\n.search-bar :deep(.el-input-group) {\n  display: flex;\n  align-items: stretch;\n}\n\n.search-bar :deep(.el-input__wrapper) {\n  background: transparent;\n  border-radius: 10px;\n  box-shadow: none;\n  border: none;\n}\n\n.search-bar :deep(.el-input-group__append) {\n  background: transparent !important;\n  border: none !important;\n  border-left: none !important;\n  box-shadow: none !important;\n  padding: 0 0 0 8px;\n  display: flex;\n  align-items: center;\n  min-width: 0;\n}\n\n.search-bar :deep(.el-input-group__append .el-button) {\n  border-radius: 8px;\n  margin: 0;\n  margin-right: 8px;\n  flex-shrink: 0;\n  height: 90%;\n  background: rgba(255, 255, 255, 0.5);\n  border: 1px solid rgba(255, 255, 255, 0.4);\n  color: var(--color-text-primary);\n}\n\n.search-bar :deep(.el-input-group__append .el-button:hover) {\n  background: rgba(255, 255, 255, 0.7);\n  border-color: rgba(255, 255, 255, 0.5);\n  color: var(--color-text-primary);\n}\n\n.input {\n  width: 100%;\n}\n.result-header {\n  margin-bottom: 16px;\n  color: var(--color-text-regular);\n  font-size: var(--font-size-sm);\n}\n.loading-wrap,\n.empty {\n  text-align: center;\n  padding: 48px;\n  color: var(--color-text-secondary);\n}\n.list-wrap {\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-md);\n}\n.item-card {\n  display: block;\n  padding: var(--spacing-lg);\n  background: var(--card-gradient);\n  border-radius: var(--border-radius-base);\n  border: 1px solid rgba(214, 211, 209, 0.7);\n  box-shadow: var(--card-shadow);\n  text-decoration: none;\n  color: inherit;\n  transition:\n    box-shadow 0.2s,\n    transform 0.2s,\n    background 0.2s;\n  backdrop-filter: blur(2px);\n}\n.item-card:hover {\n  box-shadow: var(--box-shadow-dark);\n  transform: translateY(-2px);\n  background: var(--card-gradient-hover);\n}\n.original {\n  font-size: var(--font-size-base);\n  line-height: 1.6;\n  margin-bottom: var(--spacing-sm);\n  color: var(--color-text-primary);\n}\n.translation {\n  font-size: var(--font-size-sm);\n  color: var(--color-text-regular);\n  margin-bottom: var(--spacing-xs);\n}\n.meta {\n  font-size: var(--font-size-xs);\n  color: var(--color-text-secondary);\n}\n.meta span + span::before {\n  content: ' · ';\n}\n.pagination-wrap {\n  margin-top: 24px;\n  display: flex;\n  justify-content: center;\n}\n</style>\n"],"names":["pageSize","route","useRoute","inputQ","ref","displayQuery","results","loading","searched","showTranslation","showAuthor","showDynasty","currentPage","routeQuery","computed","total","totalPages","currentPageItems","start","doSearch","q","list","search","loadFromRoute","watch","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_el_input","$event","_component_el_button","_cache","_hoisted_4","_toDisplayString","_hoisted_5","_component_el_icon","_unref","Loading","_hoisted_6","_hoisted_7","_Fragment","_renderList","item","_createBlock","_component_router_link","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_component_el_pagination"],"mappings":"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"}