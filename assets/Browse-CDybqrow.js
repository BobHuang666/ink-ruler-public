import{d as E,m as J,l as y,J as B,Q as L,a0 as M,c as n,a as r,e as a,w as l,r as c,b as _,F as P,x as U,g as w,f as O,a1 as Q,j as $,D as m,o as s,P as q,a2 as G,_ as H}from"./index-BN8HEDSF.js";import{b as N}from"./classic-HeyjI9HZ.js";const K={class:"classic-browse-page"},W={class:"browse-inner"},X={class:"browse-layout"},Y={class:"filter-sidebar"},Z={class:"filter-card"},ee={key:0,class:"pagination-wrap pagination-top"},te={key:1,class:"loading-wrap"},ae={key:2,class:"empty-wrap"},le={key:3,class:"list-wrap"},se={class:"original content-font"},oe={key:0,class:"translation"},ne={class:"meta"},re={key:0},ie={key:1},ue={key:2},ce={key:4,class:"pagination-wrap"},f=20,de=E({name:"ClassicBrowse",__name:"Browse",setup(pe){const z=["先秦","汉","三国","晋","南北朝","隋","唐","五代","宋","辽","金","元","明","清","近现代"],o=J({categories:"",authors:"",dynasties:"",genres:""}),u=y([]),p=y(!1),d=y(1),V=B(()=>Math.ceil(u.value.length/f)||1),A=B(()=>{const i=(d.value-1)*f;return u.value.slice(i,i+f)});function v(i){return i?.trim()?[i.trim()]:[]}async function F(){p.value=!0;try{const i=await N({categories:v(o.categories),authors:v(o.authors),dynasties:v(o.dynasties),genres:v(o.genres)});u.value=i??[],d.value=1}finally{p.value=!1}}async function h(){p.value=!0;try{const i=await N({random:20});u.value=i??[],d.value=1}finally{p.value=!1}}const x=y(null);return L(d,()=>{q(()=>{x.value?.scrollIntoView({behavior:"smooth",block:"start"})})}),M(()=>{G()?.name!=="ClassicItemDetail"&&h()}),(i,t)=>{const b=c("el-input"),g=c("el-form-item"),I=c("el-option"),D=c("el-select"),k=c("el-button"),R=c("el-form"),C=c("el-pagination"),S=c("el-icon"),T=c("el-empty"),j=c("router-link");return s(),n("div",K,[t[10]||(t[10]=r("div",{class:"page-bg"},[r("div",{class:"page-bg-gradient"})],-1)),r("div",W,[t[9]||(t[9]=r("section",{class:"header"},[r("h1",{class:"title title-font"},"分类浏览"),r("p",{class:"subtitle content-font"},"按分类、作者、朝代、体裁筛选")],-1)),r("div",X,[r("aside",Y,[r("div",Z,[a(R,{inline:!0,class:"filter-form"},{default:l(()=>[a(g,{label:"分类"},{default:l(()=>[a(b,{modelValue:o.categories,"onUpdate:modelValue":t[0]||(t[0]=e=>o.categories=e),placeholder:"如：家国情怀",clearable:"",style:{width:"140px"}},null,8,["modelValue"])]),_:1}),a(g,{label:"作者"},{default:l(()=>[a(b,{modelValue:o.authors,"onUpdate:modelValue":t[1]||(t[1]=e=>o.authors=e),placeholder:"如：杜甫",clearable:"",style:{width:"120px"}},null,8,["modelValue"])]),_:1}),a(g,{label:"朝代"},{default:l(()=>[a(D,{modelValue:o.dynasties,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dynasties=e),placeholder:"朝代",clearable:"",style:{width:"120px"}},{default:l(()=>[(s(),n(P,null,U(z,e=>a(I,{key:e,label:e,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"体裁"},{default:l(()=>[a(b,{modelValue:o.genres,"onUpdate:modelValue":t[3]||(t[3]=e=>o.genres=e),placeholder:"如：诗",clearable:"",style:{width:"100px"}},null,8,["modelValue"])]),_:1}),a(g,null,{default:l(()=>[a(k,{type:"primary",onClick:F},{default:l(()=>[...t[6]||(t[6]=[w("筛选",-1)])]),_:1}),a(k,{onClick:h},{default:l(()=>[...t[7]||(t[7]=[w("随机一批",-1)])]),_:1})]),_:1})]),_:1})])]),r("div",{ref_key:"contentAreaRef",ref:x,class:"content-area"},[u.value.length>0&&V.value>1?(s(),n("div",ee,[a(C,{"current-page":d.value,"onUpdate:currentPage":t[4]||(t[4]=e=>d.value=e),"page-size":f,total:u.value.length,layout:"prev, pager, next"},null,8,["current-page","total"])])):_("",!0),p.value&&u.value.length===0?(s(),n("div",te,[a(S,{class:"is-loading",size:32},{default:l(()=>[a(O(Q))]),_:1})])):u.value.length===0&&!p.value?(s(),n("div",ae,[a(T,{description:"暂无素材，请调整筛选条件或随机一批"},{default:l(()=>[a(k,{type:"primary",onClick:h},{default:l(()=>[...t[8]||(t[8]=[w("随机一批",-1)])]),_:1})]),_:1})])):(s(),n("div",le,[(s(!0),n(P,null,U(A.value,e=>(s(),$(j,{key:e.id,to:`/classic/item/${e.id}`,class:"item-card"},{default:l(()=>[r("p",se,m(e.original_text),1),e.translation?(s(),n("p",oe,m(e.translation),1)):_("",!0),r("div",ne,[e.author?(s(),n("span",re,m(e.author),1)):_("",!0),e.dynasty?(s(),n("span",ie,m(e.dynasty),1)):_("",!0),e.genre?(s(),n("span",ue,m(e.genre),1)):_("",!0)])]),_:2},1032,["to"]))),128))])),u.value.length>0&&V.value>1?(s(),n("div",ce,[a(C,{"current-page":d.value,"onUpdate:currentPage":t[5]||(t[5]=e=>d.value=e),"page-size":f,total:u.value.length,layout:"prev, pager, next"},null,8,["current-page","total"])])):_("",!0)],512)])])])}}}),me=H(de,[["__scopeId","data-v-e30c5d37"]]);export{me as default};
//# sourceMappingURL=Browse-CDybqrow.js.map
