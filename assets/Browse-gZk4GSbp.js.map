{"version":3,"file":"Browse-gZk4GSbp.js","sources":["../../src/views/classic/Browse.vue"],"sourcesContent":["<template>\n  <div class=\"classic-browse-page\">\n    <div class=\"page-bg\">\n      <div class=\"page-bg-image\" />\n      <div class=\"page-bg-gradient\" />\n    </div>\n    <div class=\"browse-inner\">\n      <section class=\"header\">\n        <h1 class=\"title title-font\">分类浏览</h1>\n        <p class=\"subtitle content-font\">按分类、作者、朝代、体裁筛选</p>\n      </section>\n      <section class=\"filters\">\n        <el-form :inline=\"true\" class=\"filter-form\">\n          <el-form-item label=\"分类\">\n            <el-input\n              v-model=\"filters.categories\"\n              placeholder=\"如：家国情怀\"\n              clearable\n              style=\"width: 140px\"\n            />\n          </el-form-item>\n          <el-form-item label=\"作者\">\n            <el-input\n              v-model=\"filters.authors\"\n              placeholder=\"如：杜甫\"\n              clearable\n              style=\"width: 120px\"\n            />\n          </el-form-item>\n          <el-form-item label=\"朝代\">\n            <el-select\n              v-model=\"filters.dynasties\"\n              placeholder=\"朝代\"\n              clearable\n              style=\"width: 120px\"\n            >\n              <el-option v-for=\"d in dynastyOpts\" :key=\"d\" :label=\"d\" :value=\"d\" />\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"体裁\">\n            <el-input\n              v-model=\"filters.genres\"\n              placeholder=\"如：诗\"\n              clearable\n              style=\"width: 100px\"\n            />\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"applyFilters\">筛选</el-button>\n            <el-button @click=\"randomBatch\">随机一批</el-button>\n          </el-form-item>\n        </el-form>\n      </section>\n      <div v-if=\"loading\" class=\"loading-wrap\">\n        <el-icon class=\"is-loading\" :size=\"32\"><Loading /></el-icon>\n      </div>\n      <div v-else class=\"list-wrap\">\n        <router-link\n          v-for=\"item in currentPageItems\"\n          :key=\"item.id\"\n          :to=\"`/classic/item/${item.id}`\"\n          class=\"item-card\"\n        >\n          <p class=\"original content-font\">{{ item.original_text }}</p>\n          <p v-if=\"item.translation\" class=\"translation\">{{ item.translation }}</p>\n          <div class=\"meta\">\n            <span v-if=\"item.author\">{{ item.author }}</span>\n            <span v-if=\"item.dynasty\">{{ item.dynasty }}</span>\n            <span v-if=\"item.genre\">{{ item.genre }}</span>\n          </div>\n        </router-link>\n      </div>\n      <div v-if=\"totalPages > 1\" class=\"pagination-wrap\">\n        <el-pagination\n          v-model:current-page=\"currentPage\"\n          :page-size=\"pageSize\"\n          :total=\"items.length\"\n          layout=\"prev, pager, next\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, computed, onMounted } from 'vue'\nimport { Loading } from '@element-plus/icons-vue'\nimport { browse } from '@/api/classic'\nimport type { ClassicItem } from '@/types/classic'\n\nconst dynastyOpts = [\n  '先秦',\n  '汉',\n  '三国',\n  '晋',\n  '南北朝',\n  '隋',\n  '唐',\n  '五代',\n  '宋',\n  '辽',\n  '金',\n  '元',\n  '明',\n  '清',\n  '近现代',\n]\n\nconst filters = reactive({\n  categories: '',\n  authors: '',\n  dynasties: '',\n  genres: '',\n})\nconst items = ref<ClassicItem[]>([])\nconst loading = ref(false)\nconst pageSize = 20\nconst currentPage = ref(1)\n\nconst totalPages = computed(() => Math.ceil(items.value.length / pageSize) || 1)\nconst currentPageItems = computed(() => {\n  const start = (currentPage.value - 1) * pageSize\n  return items.value.slice(start, start + pageSize)\n})\n\nfunction toArray(s: string): string[] {\n  if (!s?.trim()) return []\n  return [s.trim()]\n}\n\nasync function applyFilters() {\n  loading.value = true\n  try {\n    const list = await browse({\n      categories: toArray(filters.categories),\n      authors: toArray(filters.authors),\n      dynasties: toArray(filters.dynasties),\n      genres: toArray(filters.genres),\n    })\n    items.value = list ?? []\n    currentPage.value = 1\n  } finally {\n    loading.value = false\n  }\n}\n\nasync function randomBatch() {\n  loading.value = true\n  try {\n    const list = await browse({ random: 20 })\n    items.value = list ?? []\n    currentPage.value = 1\n  } finally {\n    loading.value = false\n  }\n}\n\nonMounted(() => {\n  randomBatch()\n})\n</script>\n\n<style scoped>\n.classic-browse-page {\n  position: relative;\n  min-height: calc(100vh - var(--header-height) - 80px);\n}\n.page-bg {\n  position: absolute;\n  inset: 0;\n  z-index: -1;\n}\n.page-bg-image {\n  position: absolute;\n  inset: 0;\n  background: url('/Cover.png') center/cover;\n  opacity: 0.9;\n}\n.page-bg-gradient {\n  position: absolute;\n  inset: 0;\n  background: var(--page-bg-gradient);\n}\n.browse-inner {\n  max-width: 56rem;\n  margin: 0 auto;\n  padding: 32px 16px;\n}\n.header {\n  text-align: center;\n  margin-bottom: 24px;\n}\n.title {\n  font-size: 2rem;\n  font-weight: 600;\n  margin-bottom: var(--spacing-sm);\n  color: var(--color-text-primary);\n}\n.subtitle {\n  font-size: var(--font-size-lg);\n  color: var(--color-text-regular);\n}\n.filters {\n  margin-bottom: 24px;\n}\n.filter-form {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n.loading-wrap {\n  text-align: center;\n  padding: 48px;\n}\n.list-wrap {\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-md);\n}\n.item-card {\n  display: block;\n  padding: var(--spacing-md);\n  background: var(--bg-color);\n  border-radius: var(--border-radius-base);\n  border: 1px solid var(--border-color-light);\n  text-decoration: none;\n  color: inherit;\n  transition: box-shadow 0.2s;\n}\n.item-card:hover {\n  box-shadow: var(--card-shadow);\n}\n.original {\n  font-size: var(--font-size-base);\n  line-height: 1.6;\n  margin-bottom: var(--spacing-xs);\n  color: var(--color-text-primary);\n}\n.translation {\n  font-size: var(--font-size-sm);\n  color: var(--color-text-regular);\n  margin-bottom: var(--spacing-xs);\n}\n.meta {\n  font-size: var(--font-size-xs);\n  color: var(--color-text-secondary);\n}\n.meta span + span::before {\n  content: ' · ';\n}\n.pagination-wrap {\n  margin-top: 24px;\n  display: flex;\n  justify-content: center;\n}\n</style>\n"],"names":["pageSize","dynastyOpts","filters","reactive","items","ref","loading","currentPage","totalPages","computed","currentPageItems","start","toArray","s","applyFilters","list","browse","randomBatch","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_el_form","_component_el_form_item","_component_el_input","_cache","$event","_component_el_select","_Fragment","_renderList","d","_component_el_option","_component_el_button","_hoisted_4","_component_el_icon","_unref","Loading","_hoisted_5","item","_createBlock","_component_router_link","_hoisted_6","_toDisplayString","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_component_el_pagination"],"mappings":"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"}