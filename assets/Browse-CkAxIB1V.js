import{d as me,m as Ce,l as r,J as ee,Q as we,a0 as xe,c as n,a as s,a2 as g,F as p,x as f,f as k,e as v,w as h,r as F,T as K,b as y,D as o,a4 as Q,s as W,v as q,j as $e,g as S,a1 as Oe,o as a,P as Se,a3 as Te,_ as Le}from"./index-qlAaUHAc.js";import{b as Me}from"./classic-5DaiGLHE.js";const Be={class:"classic-browse-page"},De={class:"browse-inner"},Ge={class:"sidebar"},Ae={class:"filter-section-wrap"},je={class:"filter-block"},Pe={class:"filter-controls"},Ve={class:"filter-controls-actions"},ze={class:"tags-grid-2"},Fe=["disabled","onClick"],Ne={class:"tag-btn-count"},Ie={class:"collapsible border-t pt-4 mt-4"},Ue={class:"collapsible-body"},Ee={class:"genre-space"},Je=["disabled","onClick"],Ke={class:"tag-btn-count"},Qe={class:"genre-sub-grid"},We=["disabled","onClick"],qe={class:"tag-btn-count"},He={class:"collapsible border-t pt-4 mt-4"},Re={class:"collapsible-body"},Xe={class:"filter-grid-3"},Ye=["disabled","onClick"],Ze={class:"tag-btn-count"},et={class:"collapsible border-t pt-4 mt-4"},tt={class:"collapsible-body"},st={class:"filter-grid-3"},lt=["disabled","onClick"],at={class:"tag-btn-count"},nt={class:"display-settings-wrap"},ot={class:"display-settings-grid"},it=["onClick"],ct={class:"display-toggle-label"},rt={class:"main-content"},ut={key:0,class:"pagination-wrap pagination-top"},dt={key:1,class:"grid-wrap"},vt={class:"card-inner"},pt={key:0,class:"card-original"},gt={key:1,class:"card-trans-wrap"},yt={class:"card-trans"},_t={class:"card-footer"},bt={class:"card-meta"},ft={key:4,class:"card-genre"},kt={class:"card-right"},ht={class:"card-likes"},mt={key:2,class:"loading-wrap"},Ct={key:3,class:"empty-placeholder"},wt={key:4,class:"pagination-wrap"},L=15,xt=me({name:"ClassicBrowse",__name:"Browse",setup($t){const H={格物修身:270,成长成才:185,道德情操:339,哲理思辨:593,济世情怀:67,理想信念:778,文化传承:118,人与自然:313,家国情怀:126},te=Object.keys(H),R={三国:63,先秦:100,南北朝:36,唐:757,宋:593,明:504,晋:77,汉:26},M=["先秦","汉","三国","晋","南北朝","隋","唐","五代","宋","辽","金","元","明","清","近现代"],se=[...Object.keys(R)].sort((l,e)=>(M.indexOf(l)>=0?M.indexOf(l):999)-(M.indexOf(e)>=0?M.indexOf(e):999)),B={刘知几:4,卢照邻:16,周敦颐:11,孔子:100,孟浩然:34,崔颢:11,嵇康:1,左思:15,张旭:3,张载:32,文天祥:22,曹丕:21,曹操:26,曹植:25,曾巩:18,朱熹:26,李清照:13,李白:134,李邕:1,杜甫:353,杨炯:15,梅尧臣:4,欧阳修:13,王之涣:2,王安石:27,王昌龄:48,王绩:67,程颐:14,程颢:11,苏洵:18,苏轼:59,苏辙:26,谢朓:8,谢灵运:11,辛弃疾:276,阮籍:18,陆绍珩:504,陶渊明:60,骆宾王:24,高适:45,鲍照:17,黄庭坚:23},le=[...Object.keys(B)].sort((l,e)=>(B[e]??0)-(B[l]??0)),D={诗:["七言律诗","七言排律","七言歌行","七言绝句","乐府诗","五言律诗","五言排律","五言绝句","古体诗"],词:["词"],曲:["曲"],赋:["赋"],文:["书","书启","对策","序","文","碑文","表奏","记","论","语录"]},N={语录:604,五言律诗:255,七言律诗:87,五言绝句:35,七言绝句:100,古体诗:457,词:227,论:35,文:166,五言排律:109,七言排律:2,乐府诗:9,记:28,书:12,序:9,七言歌行:2,书启:8,赋:1,表奏:3,对策:1,碑文:6},ae={文:872,诗:1056,词:227,赋:1},ne=Object.keys(D).filter(l=>(D[l]??[]).some(e=>(N[e]??0)>0)),X=Ce([{key:"original",label:"原文",value:!0},{key:"translation",label:"译文",value:!0},{key:"author",label:"作者",value:!0},{key:"dynasty",label:"朝代",value:!0},{key:"style",label:"体裁",value:!1},{key:"example",label:"范文",value:!1}]),b=r([]),G=r([]),A=r([]),u=r([]),x=r(!0),I=r(!1),$=r(!1),U=r(!1),E=r(!1),j=r(!1),P=r(!1),V=r(!1),_=r([]),z=r(!1),m=r(1),Y=ee(()=>Math.ceil(_.value.length/L)||1),oe=ee(()=>{const l=(m.value-1)*L;return _.value.slice(l,l+L)}),O=l=>X.find(e=>e.key===l)?.value,ie={格物修身:"purple",济世情怀:"indigo",道德情操:"sky",人与自然:"cyan",哲理思辨:"emerald",文化传承:"lime",理想信念:"amber",成长成才:"orange",家国情怀:"red"};function ce(l){const e=ie[l]??"gray",i=b.value.includes(l);return`tag-btn tag-cat-${e}-${i?"selected":"default"}`}const re={诗:"blue",词:"violet",曲:"pink",赋:"orange",文:"emerald"};function Z(l){return re[l]??"sky"}function ue(l){const e=Z(l),i=J(l),c=i.filter(T=>u.value.includes(T));let w="default";return c.length===i.length?w="full":c.length>0&&(w="partial"),`genre-main-btn genre-${e} genre-main-${w}`}function de(l){let e="";for(const[w,T]of Object.entries(D))if(T.includes(l)){e=w;break}const i=Z(e),c=u.value.includes(l);return`genre-sub-btn genre-${i} ${c?"genre-sub-selected":""}`}function J(l){return(D[l]??[]).filter(i=>(N[i]??0)>0)}function ve(l){const e=l.categories;return e?(Array.isArray(e)?e:String(e).split(",").map(c=>c.trim())).slice(0,2):[]}const pe={格物修身:"cat-purple",济世情怀:"cat-indigo",道德情操:"cat-sky",人与自然:"cat-cyan",哲理思辨:"cat-emerald",文化传承:"cat-lime",理想信念:"cat-amber",成长成才:"cat-orange",家国情怀:"cat-red"};function ge(l){return pe[l.trim()]??"cat-gray"}function ye(){b.value=[],C()}function _e(l){if(!I.value){if(x.value){const e=b.value.indexOf(l);e>-1?b.value.splice(e,1):b.value.push(l)}else b.value=b.value.includes(l)?[]:[l];C()}}function be(l){if($.value)return;const e=J(l);if(e.length===0)return;e.every(c=>u.value.includes(c))?u.value=u.value.filter(c=>!e.includes(c)):x.value?u.value=[...u.value.filter(c=>!e.includes(c)),...e]:u.value=e,C()}function fe(l){if(!$.value){if(x.value){const e=u.value.indexOf(l);e>-1?u.value.splice(e,1):u.value.push(l)}else u.value=u.value.includes(l)?[]:[l];C()}}function ke(l){U.value||(G.value=G.value.includes(l)?[]:[l],C())}function he(l){E.value||(A.value=A.value.includes(l)?[]:[l],C())}async function C(){z.value=!0;try{const l=await Me({categories:[...b.value],authors:[...A.value],dynasties:[...G.value],genres:[...u.value]});_.value=l??[],m.value=1}finally{z.value=!1}}return we(m,()=>{Se(()=>{window.scrollTo({top:0,behavior:"smooth"})})}),xe(()=>{Te()?.name!=="ClassicItemDetail"&&C()}),(l,e)=>{const i=F("el-icon"),c=F("el-pagination"),w=F("router-link"),T=F("el-empty");return a(),n("div",Be,[e[13]||(e[13]=s("div",{class:"page-bg"},null,-1)),s("div",De,[s("aside",Ge,[s("div",Ae,[s("div",je,[s("div",Pe,[e[6]||(e[6]=s("h3",{class:"filter-controls-title"},"主题标签",-1)),s("div",Ve,[s("button",{type:"button",class:g(["btn-multi",{active:x.value}]),onClick:e[0]||(e[0]=t=>x.value=!x.value)}," 多选 ",2),s("button",{type:"button",class:"btn-clear",onClick:ye},"清空")])]),s("div",ze,[(a(!0),n(p,null,f(k(te),t=>(a(),n("button",{key:t,type:"button",class:g(["tag-btn",[ce(t),{"tag-btn-locked":I.value}]]),disabled:I.value,onClick:d=>_e(t)},[s("span",null,o(t),1),s("span",Ne,o(H[t]??0),1)],10,Fe))),128))])]),s("div",Ie,[s("button",{type:"button",class:"collapsible-head",onClick:e[1]||(e[1]=t=>j.value=!j.value)},[e[7]||(e[7]=s("h3",{class:"collapsible-title"},"体裁分类",-1)),v(i,{class:g(["collapsible-icon",{rotate:j.value}])},{default:h(()=>[v(k(Q))]),_:1},8,["class"])]),v(K,{name:"collapse"},{default:h(()=>[W(s("div",Ue,[s("div",Ee,[(a(!0),n(p,null,f(k(ne),t=>(a(),n("div",{key:t,class:"genre-group"},[s("button",{type:"button",class:g(["genre-main-btn",[ue(t),{"tag-btn-locked":$.value}]]),disabled:$.value,onClick:d=>be(t)},[s("span",null,o(t),1),s("span",Ke,o(ae[t]??0),1)],10,Je),s("div",Qe,[(a(!0),n(p,null,f(J(t),d=>(a(),n("button",{key:d,type:"button",class:g(["genre-sub-btn",[de(d),{"tag-btn-locked":$.value}]]),disabled:$.value,onClick:Tt=>fe(d)},[s("span",null,o(d),1),s("span",qe,o(N[d]??0),1)],10,We))),128))])]))),128))])],512),[[q,j.value]])]),_:1})]),s("div",He,[s("button",{type:"button",class:"collapsible-head",onClick:e[2]||(e[2]=t=>P.value=!P.value)},[e[8]||(e[8]=s("h3",{class:"collapsible-title"},"朝代筛选",-1)),v(i,{class:g(["collapsible-icon",{rotate:P.value}])},{default:h(()=>[v(k(Q))]),_:1},8,["class"])]),v(K,{name:"collapse"},{default:h(()=>[W(s("div",Re,[s("div",Xe,[(a(!0),n(p,null,f(k(se),t=>(a(),n("button",{key:t,type:"button",class:g(["dynasty-btn",{active:G.value.includes(t),"tag-btn-locked":U.value}]),disabled:U.value,onClick:d=>ke(t)},[s("span",null,o(t),1),s("span",Ze,o(R[t]??0),1)],10,Ye))),128))])],512),[[q,P.value]])]),_:1})]),s("div",et,[s("button",{type:"button",class:"collapsible-head",onClick:e[3]||(e[3]=t=>V.value=!V.value)},[e[9]||(e[9]=s("h3",{class:"collapsible-title"},"作者筛选",-1)),v(i,{class:g(["collapsible-icon",{rotate:V.value}])},{default:h(()=>[v(k(Q))]),_:1},8,["class"])]),v(K,{name:"collapse"},{default:h(()=>[W(s("div",tt,[s("div",st,[(a(!0),n(p,null,f(k(le),t=>(a(),n("button",{key:t,type:"button",class:g(["author-btn",{active:A.value.includes(t),"tag-btn-locked":E.value}]),disabled:E.value,onClick:d=>he(t)},[s("span",null,o(t),1),s("span",at,o(B[t]??0),1)],10,lt))),128))])],512),[[q,V.value]])]),_:1})])]),s("div",nt,[s("div",ot,[(a(!0),n(p,null,f(X,t=>(a(),n("div",{key:t.key,class:"display-toggle-row",onClick:d=>t.value=!t.value},[s("span",ct,o(t.label),1),s("div",{class:g(["display-switch",{checked:t.value}])},[...e[10]||(e[10]=[s("div",{class:"display-switch-handle"},null,-1)])],2)],8,it))),128))])])]),s("main",rt,[_.value.length>0&&Y.value>1?(a(),n("div",ut,[v(c,{"current-page":m.value,"onUpdate:currentPage":e[4]||(e[4]=t=>m.value=t),"page-size":L,total:_.value.length,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):y("",!0),!z.value&&_.value.length>0?(a(),n("div",dt,[(a(!0),n(p,null,f(oe.value,t=>(a(),$e(w,{key:t.id,to:`/classic/item/${t.id}`,class:"item-card"},{default:h(()=>[s("div",vt,[O("original")?(a(),n("h3",pt,o(t.original_text),1)):y("",!0),O("translation")&&t.translation?(a(),n("div",gt,[s("p",yt,[e[11]||(e[11]=s("b",null,"翻译：",-1)),S(o(t.translation),1)])])):y("",!0),s("div",_t,[s("span",bt,[O("dynasty")&&t.dynasty?(a(),n(p,{key:0},[S("［"+o(t.dynasty)+"］",1)],64)):y("",!0),O("author")&&t.author?(a(),n(p,{key:1},[S(o(t.author),1)],64)):y("",!0),O("author")&&t.author&&t.source?(a(),n(p,{key:2},[S(" · ")],64)):y("",!0),t.source?(a(),n(p,{key:3},[S(o(t.source),1)],64)):y("",!0),O("style")&&t.genre?(a(),n("span",ft,o(t.genre),1)):y("",!0)]),s("div",kt,[s("span",ht,[e[12]||(e[12]=s("span",{class:"icon-heart"},null,-1)),S(" "+o(t.likes??0),1)]),(a(!0),n(p,null,f(ve(t),d=>(a(),n("span",{key:d,class:g(["category-tag",ge(d)])},o(d),3))),128))])])])]),_:2},1032,["to"]))),128))])):y("",!0),z.value?(a(),n("div",mt,[v(i,{class:"is-loading",size:32,color:"#999"},{default:h(()=>[v(k(Oe))]),_:1})])):_.value.length===0?(a(),n("div",Ct,[v(T,{description:"未找到相关素材，请调整筛选条件"})])):y("",!0),_.value.length>0&&Y.value>1?(a(),n("div",wt,[v(c,{"current-page":m.value,"onUpdate:currentPage":e[5]||(e[5]=t=>m.value=t),"page-size":L,total:_.value.length,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):y("",!0)])])])}}}),Bt=Le(xt,[["__scopeId","data-v-06a1ddde"]]);export{Bt as default};
//# sourceMappingURL=Browse-CkAxIB1V.js.map
