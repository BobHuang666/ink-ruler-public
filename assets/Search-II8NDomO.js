import{d as L,k as l,K as m,C as X,R as A,a8 as $,c as s,a as n,e as _,w as f,y as j,r as v,b as c,t as r,F as i,x as B,g as d,f as G,a9 as H,o as t,N as J,a2 as O,X as W,aa as Y,_ as Z}from"./index-FlaK8epA.js";import{s as ee}from"./classic-MDaJyvZ_.js";const ae={class:"classic-search-page"},te={class:"search-inner"},se={class:"search-bar"},oe={class:"search-content"},ne={key:0,class:"result-header"},re={key:1,class:"loading-wrap"},le={key:2,class:"empty"},ce={key:0,class:"pagination-wrap pagination-top"},ue={class:"list-wrap"},ie={class:"card-inner"},de={class:"card-original"},pe={key:0,class:"card-trans-wrap"},_e={class:"card-trans"},ve={class:"card-footer"},ge={class:"card-meta"},ye={key:4,class:"card-genre"},he={class:"card-right"},me={class:"card-likes"},fe={key:1,class:"pagination-wrap"},g=20,ke=L({name:"ClassicSearch",__name:"Search",setup(we){const S=X(),y=l(""),V=l(""),p=l([]),k=l(!1),w=l(!1),F=l(!0),q=l(!0),D=l(!0),u=l(1),I=m(()=>S.query.q??""),h=m(()=>p.value.length),z=m(()=>Math.ceil(h.value/g)||1),K=m(()=>{const o=(u.value-1)*g;return p.value.slice(o,o+g)}),Q={格物修身:"cat-purple",济世情怀:"cat-indigo",道德情操:"cat-sky",人与自然:"cat-cyan",哲理思辨:"cat-emerald",文化传承:"cat-lime",理想信念:"cat-amber",成长成才:"cat-orange",家国情怀:"cat-red"};function R(o){const a=o.categories;return a?(Array.isArray(a)?a:String(a).split(",").map(C=>C.trim())).slice(0,2):[]}function U(o){return Q[o.trim()]??"cat-gray"}async function b(){const o=y.value?.trim();if(o){V.value=o,k.value=!0,w.value=!0;try{const a=await ee(o,"keyword");p.value=a??[],u.value=1}finally{k.value=!1}}}function N(){const o=I.value;o&&(y.value=o,b())}return A(()=>S.query.q,N),A(u,()=>{W(()=>{window.scrollTo({top:0,behavior:"smooth"})})}),$(()=>{Y()?.name!=="ClassicItemDetail"&&N()}),(o,a)=>{const T=v("el-button"),C=v("el-input"),M=v("el-icon"),P=v("el-pagination"),E=v("router-link");return t(),s("div",ae,[n("div",te,[n("div",se,[_(C,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e),placeholder:"输入关键词搜索（如：作者、朝代、名句）",size:"large",clearable:"",class:"input",onKeyup:j(b,["enter"])},{append:f(()=>[_(T,{type:"primary",onClick:b},{default:f(()=>[...a[3]||(a[3]=[d("搜索",-1)])]),_:1})]),_:1},8,["modelValue"])]),n("div",oe,[w.value?(t(),s("div",ne,[n("span",null,"“"+r(V.value)+"” 共 "+r(h.value)+" 条",1)])):c("",!0),k.value?(t(),s("div",re,[_(M,{class:"is-loading",size:32},{default:f(()=>[_(G(H))]),_:1})])):w.value&&p.value.length===0?(t(),s("div",le,"暂无结果")):(t(),s(i,{key:3},[p.value.length>0&&z.value>1?(t(),s("div",ce,[_(P,{"current-page":u.value,"onUpdate:currentPage":a[1]||(a[1]=e=>u.value=e),"page-size":g,total:h.value,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):c("",!0),n("div",ue,[(t(!0),s(i,null,B(K.value,e=>(t(),J(E,{key:e.id,to:`/classic/item/${e.id}`,class:"item-card"},{default:f(()=>[n("div",ie,[n("h3",de,r(e.original_text),1),F.value&&e.translation?(t(),s("div",pe,[n("p",_e,[a[4]||(a[4]=n("b",null,"翻译：",-1)),d(r(e.translation),1)])])):c("",!0),n("div",ve,[n("span",ge,[D.value&&e.dynasty?(t(),s(i,{key:0},[d("［"+r(e.dynasty)+"］",1)],64)):c("",!0),q.value&&e.author?(t(),s(i,{key:1},[d(r(e.author),1)],64)):c("",!0),q.value&&e.author&&e.source?(t(),s(i,{key:2},[d(" · ")],64)):c("",!0),e.source?(t(),s(i,{key:3},[d(r(e.source),1)],64)):c("",!0),e.genre?(t(),s("span",ye,r(e.genre),1)):c("",!0)]),n("div",he,[n("span",me,[a[5]||(a[5]=n("span",{class:"icon-star"},null,-1)),d(" "+r(e.likes??0),1)]),(t(!0),s(i,null,B(R(e),x=>(t(),s("span",{key:x,class:O(["category-tag",U(x)])},r(x),3))),128))])])])]),_:2},1032,["to"]))),128))]),p.value.length>0&&z.value>1?(t(),s("div",fe,[_(P,{"current-page":u.value,"onUpdate:currentPage":a[2]||(a[2]=e=>u.value=e),"page-size":g,total:h.value,layout:"prev, pager, next",small:"",background:""},null,8,["current-page","total"])])):c("",!0)],64))])])])}}}),xe=Z(ke,[["__scopeId","data-v-5bb7240b"]]);export{xe as default};
//# sourceMappingURL=Search-II8NDomO.js.map
